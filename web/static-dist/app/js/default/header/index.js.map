{"version":3,"sources":["webpack:///./app/Resources/static-src/app/js/default/header/index.js","webpack:///./app/Resources/static-src/app/js/default/header/header.js"],"names":["HeaderNav","isClicked","init","initEvent","initNotification","bindEvent","$","on","event","stopPropagation","pcSwitcher","mobileSwitcher","length","Cookies","set","window","location","reload","remove","$informItem","isShow","css","$newNotification","api","changeTab","toNotification","mobileHistory","$target","target","preventDefault","tab","type","data","isActive","hasClass","$conversation","isEmpty","find","$dom","flag","addClass","siblings","removeClass","self","Api","before","loadingShow","then","res","informShow","catch","console","log","responseJSON","message","empty","$loading","append","$loadingDom","loading","cd","html","$item","currentTarget","href","history","go"],"mappings":"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","file":"app/js/default/header/index.js","sourcesContent":["import HeaderNav from './header.js';\n\nnew HeaderNav();\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/default/header/index.js","import Cookies from 'js-cookie';\nimport Api from 'common/api';\n\nexport default class HeaderNav {\n  constructor() {\n    this.isClicked = false;\n    this.init();\n  }\n\n  init() {\n    this.initEvent();\n    this.initNotification();\n    this.bindEvent();\n  }\n\n  initEvent() {\n    $('body').on('click', '.js-user-nav-dropdown', (event) => {\n      event.stopPropagation();\n    });\n    const pcSwitcher = $('.js-switch-pc');\n    const mobileSwitcher = $('.js-switch-mobile');\n    if (pcSwitcher.length) {\n      pcSwitcher.on('click', () => {\n        Cookies.set('PCVersion', 1);\n        window.location.reload();\n      });\n    }\n    if (mobileSwitcher.length) {\n      mobileSwitcher.on('click', () => {\n        Cookies.remove('PCVersion');\n        window.location.reload();\n      });\n    }\n  }\n\n  initNotification() {\n    const $informItem = $('.js-user-inform');\n    const isShow = $informItem.css('display') === 'block';\n    const $newNotification = $('.js-inform-newNotification');\n    if ($informItem.length && isShow) {\n      this.api('newNotification', $newNotification, true);\n    }\n  }\n\n  bindEvent() {\n    $('.js-inform-tab').on('click', (event) => this.changeTab(event));\n    $('.js-user-nav-dropdown').on('click', '.js-inform-notification', (event) => this.toNotification(event));\n    $('.js-back').on('click', () => this.mobileHistory());\n  }\n\n  changeTab(event) {\n    const $target = $(event.target);\n    this.isClicked = true;\n    event.preventDefault();\n    $target.tab('show');\n    const type = $target.data('type');\n    const isActive = $target.hasClass('active');\n    const $conversation = $('.js-inform-conversation');\n    const $newNotification = $('.js-inform-newNotification');\n    const isEmpty = $('.tab-pane.active').find('.js-inform-empty').length;\n    const $dom = (type === 'conversation') ? $conversation : $newNotification;\n    const flag = (type === 'conversation') ? false : true;\n\n    if (!isEmpty && !isActive) {\n      this.api(type, $dom, flag);\n    }\n\n    $target.addClass('active').siblings().removeClass('active');\n  }\n\n  api(type, $dom, flag) {\n    const self = this;\n    Api[type]['search']({\n      before() {\n        self.loadingShow();\n      }\n    }).then((res) => {\n      this.informShow($dom, res, flag);\n    }).catch((res) => {\n      // 异常捕获\n      console.log('catch', res.responseJSON.message);\n    });\n  }\n\n  informShow($dom, res, flag) {\n    if (this.isClicked) {\n      $dom.empty();\n    }\n    const $loading = $('.tab-pane.active').find('.js-inform-loading');\n    $loading.addClass('hidden');\n    $('.js-inform-dropdown-body').css('overflow-y', 'auto');\n    $dom.append(res);\n    if (flag) {\n      $dom.find('.notification-footer').addClass('hidden');\n      $dom.find('.pull-left').addClass('hidden');\n    }\n  }\n\n  loadingShow() {\n    const $loadingDom = $('.tab-pane.active').find('.js-inform-loading');\n    const loading = cd.loading();\n    $loadingDom.removeClass('hidden');\n    $('.js-inform-dropdown-body').css('overflow-y', 'hidden');\n    $loadingDom.html(loading);\n  }\n\n  toNotification(event) {\n    const $item = $(event.currentTarget);\n    window.location.href = $item.data('url');\n  }\n\n  mobileHistory() {\n    if (history.length !== 1) {\n      history.go(-1);\n    } else {\n      location.href = '/';\n    }\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/default/header/header.js"],"sourceRoot":""}