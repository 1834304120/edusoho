{% extends 'admin/layout.html.twig' %}

{% set menu = 'admin_invite_set' %}
{% set script_controller = 'invite/setting' %}

{% block main %}
  {{ web_macro.flash_messages() }}
    <form class="form-horizontal" method="post" id="invite-form">
      <div class="row form-group">
        <div class="col-md-2 control-label">
          <label>{{'admin.invite_setting'|trans}}</label>
        </div>
        <div class="controls col-md-7 radios">
          {{ radios('invite_code_setting', {1:'form.radio_btn.open'|trans, 0:'form.radio_btn.close'|trans}, setting('invite').invite_code_setting|default(0)) }}
        </div>
      </div>

      <div class="row form-group">
        <div class="col-md-2 control-label">
          <label for="promoted_user_batchId">{{'admin.invite_setting.promoted_user_award'|trans}}</label>
        </div>
        <div class="controls col-md-7">
          <div class="checkbox">
            <label>
              <input type="checkbox" name="promoted_user_enable" value="{{ inviteSetting.promoted_user_enable|default(0) }}"  {% if inviteSetting.promoted_user_enable|default(0) %}checked {% endif %}> 发放优惠券
            </label>
          </div>
          <div class="{% if not inviteSetting.promoted_user_enable|default(0) %}hidden {% endif %}  js-promoted-user-content user-content" style="padding-top: 5px;padding-bottom: 5px">
            <a class="btn btn-sm btn-default mtm mll" data-toggle="modal" data-target="#modal" data-url="{{ path('admin_coupon_chooser',{'type': 'promoted'}) }}">选择优惠劵</a>
            <input type="text" class="hidden js-user-batchId" id="promoted_user_batchId" name="promoted_user_batchId" value="{{ inviteSetting.promoted_user_batchId|default('')}}">
            {% include 'admin/invite/coupon-batch-table.html.twig' with {'batchId': inviteSetting.promoted_user_batchId|default('')}%}
          </div>
        </div>
      </div>

      <div class="row form-group">
        <div class="col-md-2 control-label">
          <label for="promote_user_batchId">{{'admin.invite_setting.promote_user_award'|trans}}</label>
        </div>
        <div class="controls col-md-7">
          <div class="checkbox">
            <label>
              <input type="checkbox" name="promote_user_enable" value="{{ inviteSetting.promote_user_enable|default(0) }}"  {% if inviteSetting.promote_user_enable|default(0) %}checked {% endif %}> 发放优惠券
            </label>
          </div>
          <div class="{% if not inviteSetting.promote_user_enable|default(0) %}hidden {% endif %} js-promote-user-content user-content" style="padding-top: 5px;padding-bottom: 5px">
            <a class="btn btn-sm btn-default mtm mll" data-toggle="modal" data-target="#modal" data-url="{{ path('admin_coupon_chooser',{'type': 'promote'}) }}">选择优惠劵</a>
            <input type="text" class="hidden js-user-batchId" id="promote_user_batchId" name="promote_user_batchId" value="{{ inviteSetting.promote_user_batchId|default('')}}">
            {% include 'admin/invite/coupon-batch-table.html.twig' with {'batchId': inviteSetting.promote_user_batchId|default('')}%}
          </div>
        </div>
      </div>
      <div class="row form-group">
        <div class="col-md-2 control-label">
          <label for="get_coupon_setting">{{'邀请人奖励发放时机'|trans}}</label>
        </div>
        <div class="col-md-7 radios " style="margin-top: 5px">
          {{ radios('get_coupon_setting', {0:'被邀请人注册成功时'|trans, 1:'被邀请人完成第一笔消费时'|trans}, inviteSetting.get_coupon_setting|default('1')) }}
        </div>
      </div>

      <div class="row form-group">
        <div class="col-md-2 control-label" style="white-space:nowrap;">
          <label>{{'admin.invite_setting.invite_infomation_template'|trans}}</label>
        </div>
        <div class="controls col-md-7 radios">
          <textarea class="form-control" rows="5" name="inviteInfomation_template">{{inviteInfomation_template}} </textarea>
        </div>
      </div>


      <div class="row form-group">
        <div class="col-md-2 control-label"></div>
        <div class="controls col-md-8">
          <button type="submit" class="btn btn-primary">{{'form.btn.submit'|trans}}</button>  
        </div>
      </div>

      <input type="hidden" name="_csrf_token" value="{{ csrf_token('site') }}">
    </form>

<div class="alert alert-info">
  <p><strong>{{'admin.invite_setting.notification_variable_description'|trans}}：</strong></p>
  <ul>
    <li>{% verbatim %}{{siteName}}:{% endverbatim %}{{'site.online_school_name'|trans}}</li>
    <li>{% verbatim %}{{registerUrl}}:{% endverbatim %}{{'site.register_link_url'|trans}}</li>
  </ul>
</div>

{% endblock %}