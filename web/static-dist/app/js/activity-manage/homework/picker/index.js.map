{"version":3,"sources":["webpack:///./app/Resources/static-src/app/js/activity-manage/homework/picker/index.js","webpack:///./app/Resources/static-src/app/common/component/question-subjective/index.js","webpack:///./app/Resources/static-src/app/common/component/question-picker/index.js"],"names":["$questionPickerBody","$","window","parent","document","$step2Form","contents","find","QuestionPicker","BatchSelect","SelectLinkage","questionSubjectiveRemask","$element","hasSubjective","html","$subjectiveRemask","each","type","data","console","log","length","Translator","trans","removeClass","$questionAppendForm","$questionPickerModal","closest","_initEvent","on","searchQuestion","event","pickItem","questionPreview","pagination","$batchSelectSave","batchSelectSave","$btn","currentTarget","get","attr","preventDefault","$this","$form","serialize","$target","replace","parseInt","questionId","questionIds","push","pickItemPost","url","post","replaceWith","remove","$tbody","append","trigger","_refreshSeqs","modal","open","show","index","item","seq","$tr","hasClass","val"],"mappings":"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","file":"app/js/activity-manage/homework/picker/index.js","sourcesContent":["import QuestionPicker from 'app/common/component/question-picker';\nimport BatchSelect from 'app/common/widget/batch-select';\nimport SelectLinkage from 'app/js/question-manage/widget/select-linkage.js';\n\nlet $questionPickerBody = $('#question-picker-body',window.parent.document);\nconst $step2Form = $('#task-create-content-iframe').contents().find('#step2-form');\nnew QuestionPicker($questionPickerBody , $step2Form);\nnew BatchSelect($questionPickerBody);\n\nnew SelectLinkage($('[name=\"courseId\"]',window.parent.document),$('[name=\"lessonId\"]',window.parent.document));\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/activity-manage/homework/picker/index.js","export let questionSubjectiveRemask = ($element) => {\n  let hasSubjective = false;\n  let html = '';\n  const $subjectiveRemask = $('#task-create-content-iframe').contents().find('.js-subjective-remask');\n\n  $element.find('tbody tr').each(function() {\n    let type = $(this).data('type');\n    console.log(type);\n    if (type == 'essay') {\n      hasSubjective = true;\n    }\n  });\n  console.log(hasSubjective);\n  if(hasSubjective || $element.find('tbody tr').length == 0) {\n    $subjectiveRemask.html('');\n    return;\n  }\n\n  console.log($subjectiveRemask);\n\n  if($subjectiveRemask.data('type') == 'homework') {\n    html = Translator.trans('activity.homework_manage.objective_question_hint');\n  }\n  else {\n    html = Translator.trans('activity.homework_manage.pass_objective_question_hint');\n  }\n  $subjectiveRemask.html(html).removeClass('hidden');\n};\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/common/component/question-subjective/index.js","import { questionSubjectiveRemask } from '../question-subjective';\n\nexport default class QuestionPicker {\n  constructor($questionPickerBody, $questionAppendForm) {\n    this.$questionPickerBody = $questionPickerBody;\n    this.$questionPickerModal = this.$questionPickerBody.closest('.modal');\n    this.$questionAppendForm = $questionAppendForm;\n    this._initEvent();\n  }\n\n  _initEvent() { \n    this.$questionPickerBody.find('[data-role=\"search-btn\"]').on('click', event=>this.searchQuestion(event));\n    this.$questionPickerBody.find('[data-role=\"picked-item\"]').on('click', event=>this.pickItem(event));\n    this.$questionPickerBody.find('[data-role=\"preview-btn\"]').on('click', event=>this.questionPreview(event));\n    this.$questionPickerBody.find('.pagination a').on('click', event=>this.pagination(event));\n\n    let $batchSelectSave = $('[data-role=\"batch-select-save\"]',window.parent.document);\n    $batchSelectSave.on('click',event=>this.batchSelectSave(event));\n  }\n\n\n  pagination(event) {\n    let $btn  =  $(event.currentTarget);\n    $.get($btn.attr('href'),html=> {\n      this.$questionPickerModal.html(html);\n    });\n    return false;\n  }\n\n  searchQuestion(event) {\n    event.preventDefault();\n    let $this = $(event.currentTarget);\n    let $form = $this.closest('form');\n    $.get($form.attr('action'), $form.serialize(), html => {\n      this.$questionPickerModal.html(html);\n    });\n  }\n\n  pickItem(event) {\n    let $target = $(event.currentTarget);\n    let replace = parseInt($target.data('replace'));\n    let questionId = $target.data('questionId');\n    let questionIds = [];\n    questionIds.push(questionId);\n    $target.attr('disabled',true);\n    this.pickItemPost($target.data('url'),questionIds,replace);\n  }\n\n  pickItemPost(url, questionIds, replace=null) {\n    \n    $.post(url, {questionIds:questionIds}, html=> {\n      if (replace) {\n        this.$questionAppendForm.find('tr[data-id=\"'+replace+'\"]').replaceWith(html);\n        this.$questionAppendForm.find('tr[data-parent-id=\"'+replace+'\"]').remove();\n      } else {\n        let $tbody = this.$questionAppendForm.find('tbody:visible');\n        //fix Firefox\n        if($tbody.length <= 0  ) {\n          $tbody = this.$questionAppendForm.find('tbody');\n        }\n        $tbody.append(html).removeClass('hide');\n        $tbody.trigger('lengthChange');\n      }\n      this._refreshSeqs();\n      questionSubjectiveRemask(this.$questionAppendForm);\n      this.$questionPickerModal.modal('hide');\n      $('.js-close-modal').trigger('click');\n    });\n  }\n\n  questionPreview(event) {\n    window.open($(event.currentTarget).data('url'), '_blank','directories=0,height=580,width=820,scrollbars=1,toolbar=0,status=0,menubar=0,location=0');\n  }\n\n  batchSelectSave(event) {\n    let $target = $(event.currentTarget);\n    let questionIds = [];\n    let url = $target.data('url');\n\n\n    if (this.$questionPickerBody.find('[data-role=\"batch-item\"]:checked').length == 0 ) {\n      $('.js-choice-notice',window.parent.document).show();\n      return;\n    }\n\n    this.$questionPickerBody.find('[data-role=\"batch-item\"]:checked').each(function(index,item){\n      let questionId = $(this).data('questionId');\n      questionIds.push(questionId);\n    });\n    $target.attr('disabled',true);\n    this.pickItemPost(url, questionIds,null);\n  }\n\n  _refreshSeqs() {\n    let seq = 1;\n    this.$questionAppendForm.find('tbody tr').each(function(index,item) {\n      let $tr = $(item);\n      \n      if (!$tr.hasClass('have-sub-questions')) { \n        $tr.find('td.seq').html(seq);\n        seq ++;\n      }\n    });\n    this.$questionAppendForm.find('[name=\"questionLength\"]').val((seq - 1) > 0 ? (seq - 1) : null );\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/common/component/question-picker/index.js"],"sourceRoot":""}