webpackJsonp([7],{"7/x9":function(e,t,s){"use strict";var a={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"course-detail__service"},[s("span",[e._v("承诺服务：")]),e._v(" "),e._l(e.services,function(t){return[s("span",{staticClass:"course-detail__service-icon"},[e._v(e._s(t.shortName))])]})],2)},staticRenderFns:[]},i=s("VU/8")({name:"service",props:["services"]},a,!1,null,null,null);t.a=i.exports},mjdf:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("fZjL"),i=s.n(a),r=s("Dd8w"),l=s.n(r),n={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("e-panel",{attrs:{title:e.title,defaulValue:e.defaulValue}},[e._l(e.teacherInfo,function(t){return e.teacherInfo.length?[s("div",{staticClass:"teacher-content"},[s("img",{staticClass:"avatar-img",attrs:{src:t.avatar&&t.avatar.large}}),e._v(" "),s("div",{staticClass:"teacher-cell"},[s("span",{staticClass:"dark font-family-PFM"},[e._v(e._s(t.nickname))]),e._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:t.title,expression:"item.title"}],staticClass:"text-content"},[e._v(e._s(t.title))])])])]:e._e()})],2)},staticRenderFns:[]},o=s("VU/8")({name:"teacher",props:["teacherInfo","title","defaulValue"]},n,!1,null,null,null).exports,c={data:function(){return{}},props:{cover:{type:String,default:""}}},d={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"course-detail__head"},[t("div",{staticClass:"course-detail__head--img"},[t("img",{attrs:{src:this.cover,alt:""}})])])},staticRenderFns:[]},u=s("VU/8")(c,d,!1,null,null,null).exports,v=s("upIP"),p=s("oHlh"),h=s("rsAy"),f={name:"courseSetList",components:{course:p.a,moreMask:h.a},props:{courseSets:{default:null},title:{default:""},defaulValue:{default:""},disableMask:{type:Boolean,default:!1}},data:function(){return{maxShowNum:5}},computed:{partCourseSets:function(){return this.courseSets.slice(0,5)}},methods:{loadMore:function(){this.$emit("update:disableMask",!0)}}},m={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("e-panel",{attrs:{title:e.title,needFlex:!1,defaulValue:e.defaulValue}},[e.courseSets.length?[!e.disableMask&&e.courseSets.length>5?s("moreMask",{attrs:{forceShow:!0},on:{maskLoadMore:e.loadMore}},[e._l(e.partCourseSets,function(e){return[s("course",{staticStyle:{"padding-left":"0","padding-right":"0"},attrs:{course:e}})]})],2):[e._l(e.courseSets,function(e){return[s("course",{staticStyle:{"padding-left":"0","padding-right":"0"},attrs:{course:e}})]})]]:e._e()],2)},staticRenderFns:[]},_=s("VU/8")(f,m,!1,null,null,null).exports,g=s("7/x9"),b=s("xPBg"),y={props:{details:{default:{}},joinStatus:{default:!1}},components:{service:g.a},filters:{filterPrice:function(e){return 0===Number(e)?"免费":"¥"+e}},watch:{learnExpiryHtml:{immediate:!0,handler:function(e){this.$emit("getLearnExpiry",{val:e})}}},computed:{learnExpiryHtml:function(){var e=this.joinStatus,t=this.details.expiryValue,s=this.details.expiryMode;if(e)return"forever"==s?"永久有效":0!=e.deadline?e.deadline.slice(0,10)+"之前可学习":"永久有效";switch(s){case"forever":return"永久有效";case"date":var a=new Date(1e3*t);return Object(b.formatFullTime)(a).slice(0,10)+"之前可学习";case"days":return t+"天内可学习"}}}},w={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"classroom-plan"},[s("e-panel",{attrs:{title:e.details.title}},[s("div",{staticClass:"course-detail__plan-price"},[s("span",{class:{isFree:0===Number(e.details.price)}},[e._v(e._s(e._f("filterPrice")(e.details.price)))]),e._v(" "),s("span",{staticClass:"plan-price__student-num"},[e._v(e._s(e.details.studentNum)+"人在学")])])]),e._v(" "),s("div",{staticClass:"course-detail__validity"},[e.details.service.length?s("service",{attrs:{services:e.details.service}}):e._e(),e._v(" "),s("div",[s("span",[e._v("学习有效期：")]),e._v(" "),s("span",{domProps:{innerHTML:e._s(e.learnExpiryHtml)}})])],1)],1)},staticRenderFns:[]},x=s("VU/8")(y,w,!1,null,null,null).exports,C=s("jW8y"),S={components:{directory:C.a,detailHead:u,detailPlan:x,teacher:o,courseSetList:_,reviewList:v.a,moreMask:h.a},props:["details","planDetails"],data:function(){return{headBottom:0,active:1,scrollFlag:!1,tabs:["班级介绍","班级课程","学员评价"],tabsClass:""}},mounted:function(){window.addEventListener("touchmove",this.handleScroll)},destroyed:function(){window.removeEventListener("touchmove",this.handleScroll)},methods:{handleScroll:function(){var e=this;if(!this.scrollFlag){this.scrollFlag=!0;var t=this.$refs;setTimeout(function(){e.headBottom=t.head.$el.getBoundingClientRect().bottom,e.scrollFlag=!1,e.tabsClass=e.headBottom<=0?"van-tabs--fixed":""},400)}}}},M={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"course-detail classroom-detail"},[s("div",{staticClass:"join-after"},[s("detail-head",{ref:"head",attrs:{cover:e.details.cover}}),e._v(" "),s("van-tabs",{class:e.tabsClass,model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},e._l(e.tabs,function(e){return s("van-tab",{key:e,attrs:{title:e}})})),e._v(" "),0==e.active?s("div",{staticStyle:{"margin-top":"44px"}},[s("detail-plan",{attrs:{details:e.planDetails,joinStatus:e.details.joinStatus}}),e._v(" "),s("div",{staticClass:"segmentation"}),e._v(" "),s("e-panel",{ref:"about",staticClass:"about",attrs:{title:"班级介绍"}},[s("div",{domProps:{innerHTML:e._s(e.details.summary)}})]),e._v(" "),s("div",{staticClass:"segmentation"}),e._v(" "),s("teacher",{staticClass:"teacher",attrs:{title:"教师介绍",teacherInfo:e.details.teachers}}),e._v(" "),s("div",{staticClass:"segmentation"}),e._v(" "),s("teacher",{staticClass:"teacher",attrs:{title:"班主任",teacherInfo:e.details.headTeacher?[e.details.headTeacher]:[],defaulValue:"尚未设置班主任"}})],1):e._e(),e._v(" "),1==e.active?s("div",{staticStyle:{"margin-top":"44px"}},[s("course-set-list",{ref:"course",attrs:{courseSets:e.details.courses,title:"班级课程",defaulValue:"暂无课程",disableMask:!0}})],1):e._e(),e._v(" "),2==e.active?s("div",{staticStyle:{"margin-top":"44px"}},[s("review-list",{ref:"review",attrs:{targetId:e.details.classId,reviews:e.details.reviews,title:"学员评价",defaulValue:"暂无评价",type:"classroom"}})],1):e._e()],1)])},staticRenderFns:[]},k=s("VU/8")(S,M,!1,null,null,null).exports,T=s("1JqO"),E=s("gyMJ"),V={mixins:[T.a],components:{directory:C.a,detailHead:u,detailPlan:x,teacher:o,courseSetList:_,reviewList:v.a,moreMask:h.a},props:["details","planDetails"],data:function(){return{tops:{aboutTop:0,courseTop:0,reviewTop:0},active:0,scrollFlag:!1,tabs:["班级介绍","班级课程","学员评价"],tabsClass:"",loadMoreAbout:!1,disableMask:!1,learnExpiry:"永久有效"}},computed:{accessToJoin:function(){return"success"===this.details.access.code||"user.not_login"===this.details.access.code}},mounted:function(){window.addEventListener("touchmove",this.handleScroll),window.addEventListener("scroll",this.handleScroll),setTimeout(function(){window.scrollTo(0,0)},100)},destroyed:function(){window.removeEventListener("touchmove",this.handleScroll),window.removeEventListener("scroll",this.handleScroll)},methods:{onTabClick:function(e,t){var s=this.$refs[this.transIndex2Tab(e)];window.scrollTo(0,s.$el.offsetTop-44)},transIndex2Tab:function(e){return["about","course","review"][e]},handleScroll:function(){var e=this;if(!this.scrollFlag){this.scrollFlag=!0;var t=this.$refs,s=["about","course","review"].reverse();setTimeout(function(){i()(t).forEach(function(s){e.tops[s+"Top"]=t[s].$el.getBoundingClientRect().top}),e.scrollFlag=!1,e.tabsClass=e.tops.aboutTop-44<=0?"van-tabs--fixed":"";for(var a=0;a<s.length;a++){if(e.tops[s[a]+"Top"]-44<=0)return void(e.active=s.length-a-1)}},400)}},handleJoin:function(){var e=this;if(this.accessToJoin){var t=this.details,s=this.planDetails,a="success"===t.access.code||1===Number(t.buyable)||0==+s.price;this.$store.state.token?a&&(+s.price?this.$router.push({name:"order",params:{id:t.classId},query:{expiryScope:this.learnExpiry,targetType:"classroom"}}):E.a.joinClass({query:{classroomId:t.classId}}).then(function(t){e.details.joinStatus=t}).catch(function(e){console.error(e.message)})):this.$router.push({name:"login",query:{redirect:this.redirect}})}},getLearnExpiry:function(e){var t=e.val;this.learnExpiry=t}}},L={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"course-detail classroom-detail"},[s("div",{staticClass:"join-before"},[s("detail-head",{attrs:{cover:e.details.cover}}),e._v(" "),[s("detail-plan",{attrs:{details:e.planDetails,joinStatus:e.details.joinStatus},on:{getLearnExpiry:e.getLearnExpiry}}),e._v(" "),s("div",{staticClass:"segmentation"})],e._v(" "),s("van-tabs",{class:e.tabsClass,on:{click:e.onTabClick},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},e._l(e.tabs,function(e){return s("van-tab",{key:e,attrs:{title:e}})})),e._v(" "),s("e-panel",{ref:"about",staticClass:"about",attrs:{title:"班级介绍"}},[s("more-mask",{attrs:{disabled:e.loadMoreAbout},on:{maskLoadMore:function(t){e.loadMoreAbout=!0}}},[s("div",{domProps:{innerHTML:e._s(e.details.summary)}})])],1),e._v(" "),s("div",{staticClass:"segmentation"}),e._v(" "),s("teacher",{staticClass:"teacher",attrs:{title:"教师介绍",teacherInfo:e.details.teachers}}),e._v(" "),s("div",{staticClass:"segmentation"}),e._v(" "),s("teacher",{staticClass:"teacher",attrs:{title:"班主任",teacherInfo:e.details.headTeacher?[e.details.headTeacher]:[],defaulValue:"尚未设置班主任"}}),e._v(" "),s("div",{staticClass:"segmentation"}),e._v(" "),s("course-set-list",{ref:"course",attrs:{courseSets:e.details.courses,title:"班级课程",defaulValue:"暂无课程",disableMask:e.disableMask},on:{"update:disableMask":function(t){e.disableMask=t}}}),e._v(" "),s("div",{staticClass:"segmentation"}),e._v(" "),s("review-list",{ref:"review",attrs:{targetId:e.details.classId,reviews:e.details.reviews,title:"学员评价",type:"classroom",defaulValue:"暂无评价"}}),e._v(" "),s("e-footer",{attrs:{disabled:!e.accessToJoin},nativeOn:{click:function(t){return e.handleJoin(t)}}},[e._v("\n    "+e._s(e._f("filterJoinStatus")(e.details.access.code,"classroom")))])],2)])},staticRenderFns:[]},j=s("VU/8")(V,L,!1,null,null,null).exports,I=s("NYxO"),F={components:{joinAfter:k,joinBefore:j},data:function(){return{details:{isEmpty:!0,summary:"",joinStatus:!1,courses:[],teachers:[],assistants:[],headTeacher:{},access:{code:"加载中"},cover:"",reviews:[],classId:0},planDetails:{title:"",service:[],price:"0",studentNum:0,expiryMode:"forever",expiryValue:"0"}}},computed:l()({},Object(I.mapState)({isLoading:function(e){return e.isLoading}})),created:function(){var e=this,t=this.$route.params.id;E.a.getClassroomDetail({query:{classroomId:t}}).then(function(t){e.getDetails(t)})},methods:{getDetails:function(e){var t=0===i()(e).length,s=e.about,a=!t&&e.member,r=e.courses,l=e.teachers,n=e.assistants,o=e.buyable,c=e.headTeacher,d=e.access,u=e.reviews,v=e.expiryMode,p=e.expiryValue,h=e.title,f=e.price,m=e.studentNum,_=e.service,g=e.cover.large,b=e.id,y={title:h,service:_,price:f,studentNum:m,expiryMode:v,expiryValue:p};this.planDetails=y,this.details={summary:s,joinStatus:a,isEmpty:t,courses:r,classId:b,buyable:o,teachers:l,assistants:n,headTeacher:c,access:d,cover:g,reviews:u}}}},$={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"course-detail"},[e.isLoading?s("e-loading"):e._e(),e._v(" "),e.details.joinStatus?e._e():s("join-before",{attrs:{details:e.details,planDetails:e.planDetails}}),e._v(" "),e.details.joinStatus?s("join-after",{attrs:{details:e.details,planDetails:e.planDetails}}):e._e()],1)},staticRenderFns:[]},D=s("VU/8")(F,$,!1,null,null,null);t.default=D.exports},upIP:function(e,t,s){"use strict";var a=s("GK7I"),i=s("rsAy"),r={name:"reviewList",components:{review:a.a,moreMask:i.a},props:["reviews","title","targetId","defaulValue","type"],data:function(){return{maxShowNum:5}},methods:{loadMore:function(){this.$router.push({path:"/comment/"+this.targetId,query:{type:this.type}})}},computed:{isClass:function(){return"classroom"===this.type}}},l={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("e-panel",{attrs:{title:e.title,needFlex:!1,defaulValue:e.defaulValue}},[e.reviews.length?s("moreMask",{attrs:{maxHeight:400},on:{maskLoadMore:e.loadMore}},[e._l(e.reviews,function(t){return[s("review",{attrs:{review:t,isClass:e.isClass,course:t.course}})]})],2):e._e()],1)},staticRenderFns:[]},n=s("VU/8")(r,l,!1,null,null,null);t.a=n.exports}});