{"version":3,"sources":["webpack:///external \"jQuery\"","webpack:///./app/Resources/static-src/app/js/order/create/index.js"],"names":["utils","divition","x","y","Math","round","multiple","subtract","moneyFormatFloor","value","tempValue","parseInt","toFixed","moneyFormatCeil","parseFloat","length","substr","OrderCreate","props","element","$","submitBtn","validator","coinSetting","JSON","parse","find","text","init","initEvent","validate","currentDom","couponDefaultSelect","val","couponCode","trigger","totalPrice","_this","coinNum","isNaN","coinPriceZero","showPayPassword","price_type","discount","cash_rate","shouldPay","self","click","e","coinToPay","stopPropagation","form","$this","url","data","$target","attr","modal","load","submit","$node","on","coinNumEvent","event","couponCodeEvent","couponCancelEvent","couponUseEvent","couponSelectEvent","formSubmitEvent","currentTarget","coupon","children","show","hide","removeClass","code","targetType","targetId","amount","post","css","useable","addClass","html","Translator","trans","rate","decreaseAmount","conculatePrice","focus","couponTotalPrice","trim","accountCash","coin","cashDiscount","totalCoinPrice","maxCoin","maxCoinCanPay","myCashAccount","myCash","payRmb","shouldPayMoney","coinNumPay","afterCouponPay","cashModel","cash_model","getMaxCoinCanPay","afterCoinPay","rules","required","es_remote"],"mappings":"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","file":"app/js/order/create/index.js","sourcesContent":["module.exports = jQuery;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jQuery\"\n// module id = 0\n// module chunks = app/js/main app/js/v2/demo/index app/js/activity-manage/doc/index app/js/activity-manage/download/index app/js/activity-manage/flash/index app/js/activity-manage/homework/index app/js/activity-manage/ppt/index app/js/activity-manage/video/index app/js/article/detail/index app/js/attachment/index app/js/auth/captcha-modal/index app/js/auth/password-reset/index app/js/auth/register/index app/js/batch-upload/index app/js/card/card-receive/index app/js/card/index/index app/js/cashier/index app/js/cashier/modal/index app/js/classroom-manage/set-picture/index app/js/classroom-manage/student-expiryday/index app/js/classroom-manage/student-import/index app/js/classroom-manage/students-create/index app/js/classroom-manage/students-manage/index app/js/classroom/buy-modal/index app/js/classroom/index app/js/classroom/thread-form/index app/js/classroom/thread-show/index app/js/coin/invite-code/index app/js/course-chapter-manage/index app/js/course-manage-file/index/index app/js/course-manage/batch-create/index app/js/course-manage/lesson-manage/default/index app/js/course-manage/lesson-manage/normal/index app/js/course-manage/live-replay/upload/index app/js/course-manage/overview/index app/js/course-manage/student-import/index app/js/course/buy-modal/index app/js/course/thread-show/index app/js/courseset/show/index app/js/exporter/index app/js/group/index app/js/group/logo/index app/js/group/thread-add/index app/js/live-course/explore/index app/js/material-lib/index/index app/js/material-lib/share-history/index app/js/media-manage/index app/js/activity-manage/audio/index app/js/mobile-bind/index app/js/my/order-refund-apply/index app/js/my/order-refund/index app/js/my/order/index app/js/oauth2/create/index app/js/open-course-manage/add-material/index app/js/open-course-manage/lesson-modal/index app/js/open-course/index app/js/open-course/member-sms/index app/js/order/coupon-item/index app/js/order/create-sms/index app/js/order/create/index app/js/pay/select/index app/js/pay/show-mobile-modal/index app/js/player/index app/js/question-manage/form/index app/js/review/list/index app/js/search/index app/js/settings/avatar-crop-modal/index app/js/settings/bind-mobile/index app/js/settings/email/index app/js/settings/find_pay_password_by_sms/index app/js/settings/find-pay-password/index app/js/settings/password/index app/js/settings/pay-password-modal/index app/js/settings/pay-password/index app/js/settings/profile/index app/js/settings/reset-pay-password/index app/js/settings/security-questions/index app/js/settings/security/index app/js/settings/setup-password/index app/js/settings/setup/index app/js/settings/update-pay-password/index app/js/settings/user-profile/index app/js/subject/index app/js/task-manage/create/index app/js/task/plugin/note/index app/js/task/plugin/question/index app/js/testpaper-manage/create/index app/js/testpaper-manage/index app/js/testpaper-manage/questions/index app/js/testpaper/do-test/exercise/index app/js/testpaper/do-test/normal/index app/js/testpaper/result/index app/js/thread/user-info-modal/index app/js/user/fill-info/index app/js/message/show/index","import notify from 'common/notify';\n\nlet utils = {\n  divition(x, y) {\n    return Math.round(Math.round(x * 1000) / Math.round(y * 1000) * 1000) / 1000;\n  },\n  multiple(x, y) {\n    return Math.round(Math.round(x * 100) * Math.round(y * 100)) / 10000;\n  },\n  subtract(x, y) {\n    return Math.round(Math.round(x * 1000) - Math.round(y * 1000)) / 1000;\n  },\n  moneyFormatFloor(value) {\n    // 转化成字符串\n    let tempValue = value + '';\n    tempValue = parseInt(Math.round(tempValue * 1000));\n    // 抹去最后１位\n    tempValue = parseInt(tempValue / 10) * 10 / 1000;\n    return tempValue.toFixed(2);\n  },\n  moneyFormatCeil(value) {\n    let tempValue = value + '';\n    tempValue = parseFloat(tempValue).toFixed(3);\n    let length = tempValue.length;\n    if (tempValue.substr(length - 1, 1) === '0') {\n      return this.moneyFormatFloor(tempValue);\n    }\n    return this.moneyFormatFloor(parseFloat(tempValue) + 0.01);\n  }\n};\n\n\nclass OrderCreate {\n  constructor(props) {\n    this.element = $(props.element);\n    this.submitBtn = '#order-create-btn';\n    this.validator = null;\n    this.coinSetting = JSON.parse(this.element.find('.js-coin-setting ').text());\n    this.init();\n  }\n\n  init() {\n    this.initEvent();\n    this.validator = this.element.validate({\n      currentDom: this.submitBtn,\n    });\n\n    let couponDefaultSelect = $('#coupon-select').val();\n    if (couponDefaultSelect != '') {\n      let couponCode = $('[role=\"coupon-code-input\"]');\n      couponCode.val(couponDefaultSelect);\n      $('button[role=\"coupon-use\"]').trigger('click');\n    }\n\n    let totalPrice = parseFloat($('[role=\"total-price\"]').text());\n    let _this = this;\n    if ($('[role=\"coinNum\"]').length > 0) {\n      let coinNum = $('[role=\"coinNum\"]').val();\n      if (isNaN(coinNum) || coinNum <= 0) {\n        $(this).val('0.00');\n        _this.coinPriceZero();\n      } else {\n        _this.showPayPassword();\n      }\n\n      if (_this.coinSetting.price_type == 'RMB') {\n        let discount = utils.divition(coinNum, _this.coinSetting.cash_rate);\n        if (totalPrice < discount) {\n          discount = totalPrice;\n        }\n        $('[role=\"cash-discount\"]').text(utils.moneyFormatFloor(discount));\n        totalPrice = utils.subtract(totalPrice, discount);\n      } else {\n        $('[role=\"cash-discount\"]').text(utils.moneyFormatFloor(coinNum));\n        totalPrice = utils.subtract(totalPrice, coinNum);\n      }\n    } else {\n      $('[role=\"cash-discount\"]').text('0.00');\n    }\n\n    this.shouldPay(totalPrice);\n\n    if ($('#js-order-create-sms-btn').length > 0) {\n      let self = this;\n\n      $('#js-order-create-sms-btn').click(function(e) {\n\n        let coinToPay = $('#coinPayAmount').val();\n        if (coinToPay && (coinToPay.length > 0) && (!isNaN(coinToPay)) && (coinToPay > 0) && ($('#js-order-create-sms-btn').length > 0)) {\n          $('#payPassword').trigger('change');\n          if ($('[role=\"password-input\"]').find('span[class=\"text-danger\"]').length > 0) {\n            e.stopPropagation();\n          }\n\n          if (self.validator && self.validator.form()) {\n            let $this = $(this);\n            let url = $this.data('url');\n            let $target = $($this.attr('data-target'));\n            $target.modal().load(url);\n          }\n\n        } else {\n          e.stopPropagation();\n          $('#order-create-form').submit();\n        }\n      });\n    }\n  }\n\n  initEvent() {\n    const $node = this.element;\n    $node.on('blur', '[role=\"coinNum\"]', event => this.coinNumEvent(event));\n    $node.on('click', '#coupon-code-btn', event => this.couponCodeEvent(event));\n    $node.on('click', '[role=\"cancel-coupon\"]', event => this.couponCancelEvent(event));\n    $node.on('click', 'button[role=\"coupon-use\"]', event => this.couponUseEvent(event));\n    $node.on('change', '#coupon-select', event => this.couponSelectEvent(event));\n    $node.on('click', this.submitBtn, event => this.formSubmitEvent(event));\n  }\n\n  formSubmitEvent(event) {\n    if (this.validator && this.validator.form()) {\n      this.element.submit();\n    }\n  }\n\n  couponSelectEvent(event) {\n    const $this = $(event.currentTarget);\n    const coupon = $this.children('option:selected');\n    if (coupon.data('code') == '') {\n      $('[role=no-use-coupon-code]').show();\n      $('[role=\"cancel-coupon\"]').trigger('click');\n      return;\n    } else {\n      $('[role=no-use-coupon-code]').hide();\n    }\n    let couponCode = $('[role=\"coupon-code-input\"]');\n    couponCode.val(coupon.data('code'));\n    $('button[role=\"coupon-use\"]').trigger('click');\n    $('[role=\"code-notify\"]').removeClass('alert-success');\n  }\n\n  couponUseEvent(event) {\n    let data = {};\n    let couponCode = $('[role=\"coupon-code-input\"]');\n    data.code = couponCode.val();\n\n    if (data.code == '') {\n      $('[role=\"coupon-price-input\"]').find('[role=\\'price\\']').text('0.00');\n      return;\n    }\n\n    data.targetType = couponCode.data('targetType');\n    data.targetId = couponCode.data('targetId');\n\n    let totalPrice = parseFloat($('[role=\"total-price\"]').text());\n\n    data.amount = totalPrice;\n    let _this = this;\n    $.post('/' + data.targetType + '/' + data.targetId + '/coupon/check', data, function(data) {\n      $('[role=\"code-notify\"]').css('display', 'inline-block');\n      if (data.useable == 'no') {\n\n        $('[role=no-use-coupon-code]').show();\n        $('[role=\"code-notify\"]').removeClass('alert-success').addClass('alert-danger').html(Translator.trans('order.create.useless_hint'));\n\n      } else if (data.useable == 'yes') {\n        $('[role=no-use-coupon-code]').hide();\n\n        if (data['type'] == 'discount') {\n          $('[role=\"code-notify\"]').removeClass('alert-danger').addClass('alert-success').text(Translator.trans('order.create.use_discount_coupon_hint', { rate: data['rate'] }));\n        } else {\n          $('[role=\"code-notify\"]').removeClass('alert-danger').addClass('alert-success').text(Translator.trans('order.create.use_price_coupon_hint', { rate: data['rate'] }));\n        }\n\n        $('[role=\"coupon-price\"]').find('[role=\\'price\\']').text(utils.moneyFormatFloor(data.decreaseAmount));\n\n        $('[role=\"coupon-code-verified\"]').val(couponCode.val());\n      }\n\n      _this.conculatePrice();\n    });\n  }\n\n  couponCancelEvent(event) {\n    if ($('#coupon-select').val() != '') {\n      let couponDefaultSelect = $('#coupon-select').val();\n      let couponCode = $('[role=\"coupon-code-input\"]');\n      couponCode.val(couponDefaultSelect);\n      $('button[role=\"coupon-use\"]').trigger('click');\n    }\n\n    $('[role=\"coupon-code\"]').hide();\n    // $('[role=\"no-use-coupon-code\"]').show();\n    $('#coupon-code-btn').show();\n    $('[role=\"null-coupon-code\"]').show();\n    $('[role=\"code-notify\"]').hide();\n    $('[role=\"coupon-price\"]').find('[role=\\'price\\']').text('0.00');\n    $('[role=\"code-notify\"]').text('');\n    $('[role=\"coupon-code\"]').val('');\n    $(this).hide();\n    $('[role=\"coupon-code-verified\"]').val('');\n    $('[role=\"coupon-code-input\"]').val('');\n\n    this.conculatePrice();\n  }\n\n  coinNumEvent(event) {\n    const $this = $(event.currentTarget);\n    let coinNum = $this.val();\n    coinNum = Math.round(coinNum * 100) / 100;\n    $this.val(coinNum);\n\n    if (isNaN(coinNum) || coinNum <= 0) {\n      $this.val('0.00');\n      this.coinPriceZero();\n    } else {\n      this.showPayPassword();\n    }\n    this.conculatePrice();\n  }\n\n  couponCodeEvent(event) {\n    const $this = $(event.currentTarget);\n    // $('[role=\"cancel-coupon\"]').trigger('click');\n    $('[role=\"coupon-price\"]').find('[role=\\'price\\']').text('0.00');\n    $('[role=\"code-notify\"]').text('').removeClass('alert-success');\n    $('[role=\"coupon-code\"]').val('');\n    $('[role=\"cancel-coupon\"]').hide();\n    $('[role=\"coupon-code-verified\"]').val('');\n    $('[role=\"coupon-code-input\"]').val('');\n    this.conculatePrice();\n    $('[role=\"coupon-code\"]').show();\n    $('[role=\"coupon-code-input\"]').focus();\n    // $('[role=\"no-use-coupon-code\"]').hide();\n    $('[role=\"cancel-coupon\"]').show();\n    $('[role=\"null-coupon-code\"]').hide();\n\n    // $('[role=\"code-notify\"]').show();\n    $this.hide();\n  }\n\n  afterCouponPay(totalPrice) {\n    let couponTotalPrice = $('[role=\"coupon-price\"]').find('[role=\\'price\\']').text();\n    if ($.trim(couponTotalPrice) == '' || isNaN(couponTotalPrice)) {\n      couponTotalPrice = 0;\n    }\n    if (totalPrice < couponTotalPrice) {\n      couponTotalPrice = totalPrice;\n    }\n    totalPrice = utils.subtract(totalPrice, couponTotalPrice);\n    return totalPrice;\n  }\n\n  afterCoinPay(coinNum) {\n    let accountCash = $('[role=\"accountCash\"]').text();\n\n    if (accountCash == '' || isNaN(accountCash) || parseFloat(accountCash) == 0) {\n      this.coinPriceZero();\n      return 0;\n    }\n\n    let coin = Math.round(accountCash * 1000) > Math.round(coinNum * 1000) ? coinNum : accountCash;\n\n    if (this.coinSetting.price_type == 'RMB') {\n      let totalPrice = parseFloat($('[role=\"total-price\"]').text());\n      let cashDiscount = Math.round(utils.moneyFormatFloor(utils.divition(coin, this.coinSetting.cash_rate)) * 100) / 100;\n\n      if (totalPrice < cashDiscount) {\n        cashDiscount = totalPrice;\n      }\n\n      $('[role=\"cash-discount\"]').text(utils.moneyFormatFloor(cashDiscount));\n    } else {\n      $('[role=\"cash-discount\"]').text(utils.moneyFormatFloor(coin));\n    }\n    return coin;\n\n  }\n\n  getMaxCoinCanPay(totalCoinPrice) {\n    let maxCoin = parseFloat($('[role=\"maxCoin\"]').text());\n    let maxCoinCanPay = totalCoinPrice < maxCoin ? totalCoinPrice : maxCoin;\n    let myCashAccount = $('[role=\"accountCash\"]');\n\n    if (myCashAccount.length > 0) {\n      let myCash = parseFloat(myCashAccount.text() * 100) / 100;\n      maxCoinCanPay = maxCoinCanPay < myCash ? maxCoinCanPay : myCash;\n    }\n\n    return maxCoinCanPay;\n  }\n\n  shouldPay(totalPrice) {\n    totalPrice = Math.round(totalPrice * 1000) / 1000;\n\n    if (this.coinSetting.price_type == 'RMB') {\n      totalPrice = utils.moneyFormatCeil(totalPrice);\n      $('[role=\"pay-rmb\"]').text(totalPrice);\n      $('input[name=\"shouldPayMoney\"]').val(totalPrice);\n\n    } else {\n      let payRmb = utils.moneyFormatCeil(utils.divition(totalPrice, this.coinSetting.cash_rate));\n      let shouldPayMoney = Math.round(payRmb * 100) / 100;\n\n      $('[role=\"pay-coin\"]').text(totalPrice);\n      $('[role=\"pay-rmb\"]').text(shouldPayMoney);\n      $('input[name=\"shouldPayMoney\"]').val(shouldPayMoney);\n    }\n  }\n\n  conculatePrice() {\n    let totalPrice = parseFloat($('[role=\"total-price\"]').text()),\n      totalCoinPrice = 0,\n      cashDiscount = $('[role=\"cash-discount\"]').text(),\n      coinNumPay = $('[role=\"coinNum\"]').val();\n\n    totalPrice = this.afterCouponPay(totalPrice);\n\n    let cashModel = this.coinSetting.cash_model;\n\n    switch (cashModel) {\n    case 'none':\n      totalPrice = totalPrice >= 0 ? totalPrice : 0;\n      this.shouldPay(totalPrice);\n      break;\n    case 'deduction':\n      totalCoinPrice = utils.multiple(totalPrice, this.coinSetting.cash_rate);\n      totalCoinPrice = utils.moneyFormatCeil(totalCoinPrice);\n      var maxCoinCanPay = this.getMaxCoinCanPay(totalCoinPrice);\n\n      if (maxCoinCanPay <= parseFloat(coinNumPay)) {\n        coinNumPay = maxCoinCanPay;\n      }\n\n      $('[role=\"coinNum\"]').val(coinNumPay);\n\n      if (coinNumPay == 0) {\n        this.coinPriceZero();\n      }\n\n      if (coinNumPay && $('[name=\"payPassword\"]').length > 0) {\n        coinNumPay = this.afterCoinPay(coinNumPay);\n        totalPrice = utils.subtract(totalPrice, cashDiscount);\n\n      } else {\n        $('[role=\"coinNum\"]').val(0);\n        $('[role=\"cash-discount\"]').text('0.00');\n      }\n\n      totalPrice = totalPrice >= 0 ? totalPrice : 0;\n      this.shouldPay(totalPrice);\n      break;\n    case 'currency':\n      totalCoinPrice = totalPrice;\n\n      if (totalCoinPrice <= parseFloat(coinNumPay)) {\n        coinNumPay = totalCoinPrice;\n      }\n\n      $('[role=\"coinNum\"]').val(coinNumPay);\n\n      if (coinNumPay == 0) {\n        this.coinPriceZero();\n      }\n\n      if (coinNumPay && $('[name=\"payPassword\"]').length > 0) {\n        coinNumPay = this.afterCoinPay(coinNumPay);\n        totalPrice = utils.subtract(totalPrice, cashDiscount);\n      } else {\n        $('[role=\"coinNum\"]').val(0);\n        $('[role=\"cash-discount\"]').text('0.00');\n      }\n\n      totalPrice = totalPrice >= 0 ? totalPrice : 0;\n      this.shouldPay(totalPrice);\n      break;\n    }\n  }\n\n  coinPriceZero() {\n    $('[role=\"coinNum\"]').val(0);\n    $('[role=\"cash-discount\"]').data('defaultValue');\n    $('[role=\\'password-input\\']').hide();\n    $('[name=\"payPassword\"]').rules('remove', 'required es_remote');\n  }\n\n  showPayPassword() {\n    $('[role=\\'password-input\\']').show();\n    $('[name=\"payPassword\"]').rules('add', { required: true, es_remote: true });\n  }\n}\n\nnew OrderCreate({\n  element: '#order-create-form'\n});\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/order/create/index.js"],"sourceRoot":""}