{"version":3,"sources":["webpack:///./app/Resources/static-src/app/js/activity-manage/exercise/index.js"],"names":["Exercise","$form","$element","validator2","_setValidateRule","_init","_initEvent","_inItStep2form","fix","$step2_form","$","validate","rules","title","required","maxlength","trim","course_title","itemCount","positiveInteger","min","max","range","difficulty","remote","url","data","type","dataType","async","val","courseId","length","lessonId","types","each","push","messages","Translator","trans","$step3_form","validator","onkeyup","finishCondition","addMethod","value","element","optional","test","format","click","form","SelectLinkage","checkQuestionNum","change","post","text","i","n","questionNum"],"mappings":"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","file":"app/js/activity-manage/exercise/index.js","sourcesContent":["import SelectLinkage from 'app/js/question-manage/widget/select-linkage.js';\n\nclass Exercise {\n  constructor($form) {\n    this.$element = $form;\n    this.validator2 = null;\n    this._setValidateRule();\n    this._init();\n    this._initEvent();\n    \n  }\n\n  _init() {\n    this._inItStep2form();\n    this.fix();\n  }\n\n  _initEvent() {\n  }\n\n  _inItStep2form() {\n    let $step2_form = $('#step2-form');\n\n    this.validator2 = $step2_form.validate({\n      rules: {\n        title: {\n          required: true,\n          maxlength: 50,\n          trim: true,\n          course_title: true,\n        },\n        itemCount: {\n          required: true,\n          positiveInteger: true,\n          min: 1,\n          max: 9999\n        },\n        range: {\n          required: true,\n        },\n        difficulty: {\n          required: true\n        },\n        'questionTypes[]': {\n          required: true,\n          remote: {\n            url: $('[name=\"checkQuestion\"]').data('checkUrl'),\n            type: 'post',\n            dataType: 'json',\n            async: false,\n            data: {\n              itemCount: function () {\n                return $('[name=\"itemCount\"]').val();\n              },\n              range: function () {\n                let range = {};\n                let courseId = $('[name=\"range[courseId]\"]').val();\n                range.courseId = courseId;\n                if ($('[name=\"range[lessonId]\"]').length > 0) {\n                  let lessonId = $('[name=\"range[lessonId]\"]').val();\n                  range.lessonId = lessonId;\n                }\n\n                return JSON.stringify(range);\n              },\n              difficulty: function () {\n                return $('[name=\"difficulty\"]').val();\n              },\n              types: function () {\n                let types = [];\n                $('[name=\"questionTypes\\[\\]\"]:checked').each(function () {\n                  types.push($(this).val());\n                });\n                return types;\n              }\n            }\n          }\n        }\n      },\n      messages: {\n        required: Translator.trans('activity.exercise_manage.title_required_error_hint'),\n        range: Translator.trans('activity.exercise_manage.title_range_error_hint'),\n        itemCount: {\n          required: Translator.trans('activity.exercise_manage.item_count_required_error_hint'),\n          positiveInteger: Translator.trans('activity.exercise_manage.item_count_positive_integer_error_hint'),\n          min: Translator.trans('activity.exercise_manage.item_count_min_error_hint'),\n          max: Translator.trans('activity.exercise_manage.item_count_max_error_hint')\n        },\n        difficulty: Translator.trans('activity.exercise_manage.difficulty_required_error_hint'),\n        'questionTypes[]': {\n          required: Translator.trans('activity.exercise_manage.question_required_error_hint'),\n          remote: Translator.trans('activity.exercise_manage.question_remote_error_hint')\n        },\n      }\n    });\n\n    $step2_form.data('validator', this.validator2);\n  }\n\n  _inItStep3form() {\n    var $step3_form = $('#step3-form');\n    var validator = $step3_form.validate({\n      onkeyup: false,\n      rules: {\n        finishCondition: {\n          required: true,\n        },\n      },\n      messages: {\n        finishCondition: Translator.trans('activity.exercise_manage.finish_detail_required_error_hint'),\n      }\n    });\n    $step3_form.data('validator', validator);\n  }\n\n  _setValidateRule() {\n    $.validator.addMethod('positiveInteger', function (value, element) {\n      return this.optional(element) || /^[1-9]\\d*$/.test(value);\n    }, $.validator.format(Translator.trans('activity.exercise_manage.item_count_positive_integer_error_hint')));\n\n  }\n\n  fix() {\n    $('.js-question-type').click(() => {\n      this.validator2.form();\n    });\n  }\n}\n\nnew Exercise($('#step2-form'));\nnew SelectLinkage($('[name=\"range[courseId]\"]'), $('[name=\"range[lessonId]\"]'));\n\ncheckQuestionNum();\n\n$('[name=\"range[courseId]\"]').change(function () {\n  checkQuestionNum();\n});\n\n$('[name=\"range[lessonId]\"]').change(function () {\n  checkQuestionNum();\n});\n\n$('[name=\"difficulty\"]').change(function () {\n  checkQuestionNum();\n});\n\nfunction checkQuestionNum() {\n  let url = $('[name=\"range[courseId]\"]').data('checkNumUrl');\n  let courseId = $('[name=\"range[courseId]\"]').val();\n  let lessonId = $('[name=\"range[lessonId]\"]').val();\n  let difficulty = $('[name=\"difficulty\"]').val();\n\n  $.post(url, { courseId: courseId, lessonId: lessonId, difficulty: difficulty }, function (data) {\n    $('[role=\"questionNum\"]').text(0);\n\n    $.each(data, function (i, n) {\n      $('[type=\\'' + i + '\\']').text(n.questionNum);\n    });\n  });\n}\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/activity-manage/exercise/index.js"],"sourceRoot":""}