{"version":3,"sources":["webpack:///external \"jQuery\"","webpack:///./app/Resources/static-src/app/js/auth/register/index.js","webpack:///./app/Resources/static-src/app/js/auth/register/register.js"],"names":["Register","drag","$","length","Drag","limitType","setValidateRule","dragEvent","initValidator","inEventMobile","initMobileMsgVeriCodeSendBtn","initFieldVisitId","self","on","token","_smsBtnable","validator","addMethod","value","element","indexOf","format","Translator","trans","validate","_validataRules","params","reg_email","reg_mobile","result","isEmail","test","isMobile","removeClass","captchEnable","addClass","messages","email_or_mobile_check","optional","blur","emailOrMobile","val","emSmsCodeValidate","mobile","rules","required","attr","unsigned_integer","rangelength","es_remote","type","$smsSendBtn","click","_smsBtnDisable","fieldName","SmsSender","url","data","smsType","dataTo","captcha","captchaValidated","captchaNum","preSmsSend","error","initDragCaptcha","additionalAction","ackResponse","nickname","byte_minlength","byte_maxlength","chinese_alphanumeric","password","minlength","maxlength","spaceNoSupport","email","invitedCode","reg_inviteCode","callback","bool","verifiedMobile","phone","dragCaptchaToken","agree_policy","initSmsCodeRule","initDragCaptchaCodeRule","document","ready","window","_VISITOR_ID"],"mappings":";;;;;AAAA,wB;;;;;;;;;;ACAA;;;;;;AACA,IAAIA,kBAAJ,G;;;;;;;;;;;;;;;;;;;;;;ACDA;;;;AACA;;;;;;IAEqBA,Q;AACnB,sBAAc;AAAA;;AACZ,SAAKC,IAAL,GAAYC,EAAE,WAAF,EAAeC,MAAf,GAAwB,IAAIC,cAAJ,CAASF,EAAE,WAAF,CAAT,EAAyBA,EAAE,YAAF,CAAzB,EAA0C;AAC5EG,iBAAW;AADiE,KAA1C,CAAxB,GAEP,IAFL;AAGA,SAAKC,eAAL;AACA,SAAKC,SAAL;AACA,SAAKC,aAAL;AACA,SAAKC,aAAL;AACA,SAAKC,4BAAL;AACA,SAAKC,gBAAL;AACD;;;;gCAEW;AACV,UAAIC,OAAO,IAAX;AACA,UAAI,KAAKX,IAAT,EAAe;AACb,aAAKA,IAAL,CAAUY,EAAV,CAAa,SAAb,EAAwB,UAASC,KAAT,EAAe;AACrCF,eAAKG,WAAL;AACD,SAFD;AAGD;AACF;;;sCAEiB;AAChBb,QAAEc,SAAF,CAAYC,SAAZ,CAAsB,gBAAtB,EAAwC,UAAUC,KAAV,EAAiBC,OAAjB,EAA0B;AAChE,eAAOD,MAAME,OAAN,CAAc,GAAd,IAAqB,CAA5B;AACD,OAFD,EAEGlB,EAAEc,SAAF,CAAYK,MAAZ,CAAmBC,WAAWC,KAAX,CAAiB,sBAAjB,CAAnB,CAFH;AAGD;;;oCAEe;AACd,UAAIX,OAAO,IAAX;AACAV,QAAE,gBAAF,EAAoBsB,QAApB,CAA6B,KAAKC,cAAL,EAA7B;AACAvB,QAAEc,SAAF,CAAYC,SAAZ,CAAsB,uBAAtB,EAA+C,UAASC,KAAT,EAAgBC,OAAhB,EAAyBO,MAAzB,EAAiC;AAC9E,YAAIC,YAAY,mEAAhB;AACA,YAAIC,aAAa,WAAjB;AACA,YAAIC,SAAS,KAAb;AACA,YAAIC,UAAUH,UAAUI,IAAV,CAAeb,KAAf,CAAd;AACA,YAAIc,WAAWJ,WAAWG,IAAX,CAAgBb,KAAhB,CAAf;AACA,YAAIc,QAAJ,EAAc;AACZ9B,YAAE,mBAAF,EAAuB+B,WAAvB,CAAmC,QAAnC;AACA,cAAI,CAACrB,KAAKsB,YAAV,EAAwB;AACtBhC,cAAE,iBAAF,EAAqBiC,QAArB,CAA8B,QAA9B;AACD;AACF,SALD,MAKO;AACLjC,YAAE,mBAAF,EAAuBiC,QAAvB,CAAgC,QAAhC;AACAjC,YAAE,iBAAF,EAAqB+B,WAArB,CAAiC,QAAjC;AACD;AACD,YAAIH,WAAWE,QAAf,EAAyB;AACvBH,mBAAS,IAAT;AACD;AACD3B,UAAEc,SAAF,CAAYoB,QAAZ,CAAqBC,qBAArB,GAA6Cf,WAAWC,KAAX,CAAiB,kCAAjB,CAA7C;AACA,eAAO,KAAKe,QAAL,CAAcnB,OAAd,KAA0BU,MAAjC;AACD,OApBD,EAoBGP,WAAWC,KAAX,CAAiB,wCAAjB,CApBH;AAqBD;;;oCAEe;AAAA;;AACdrB,QAAE,yBAAF,EAA6BqC,IAA7B,CAAkC,YAAM;AACtC,YAAIC,gBAAgBtC,EAAE,yBAAF,EAA6BuC,GAA7B,EAApB;AACA,cAAKC,iBAAL,CAAuBF,aAAvB;AACD,OAHD;;AAKAtC,QAAE,kBAAF,EAAsBqC,IAAtB,CAA2B,YAAM;AAC/B,YAAII,SAASzC,EAAE,kBAAF,EAAsBuC,GAAtB,EAAb;AACA,cAAKC,iBAAL,CAAuBC,MAAvB;AACD,OAHD;AAID;;;8CAEyB;AACxB,UAAIzC,EAAE,cAAF,EAAkBC,MAAtB,EAA8B;AAC5BD,UAAE,2BAAF,EAA+B0C,KAA/B,CAAqC,KAArC,EAA4C;AAC1CC,oBAAU,IADgC;AAE1CT,oBAAU;AACRS,sBAAUvB,WAAWC,KAAX,CAAiB,iCAAjB;AADF;AAFgC,SAA5C;AAMD;AACF;;;qCAEgB;AACfrB,QAAE,kBAAF,EAAsBiC,QAAtB,CAA+B,UAA/B,EAA2CW,IAA3C,CAAgD,UAAhD,EAA4D,IAA5D;AACD;;;kCAEa;AACZ5C,QAAE,kBAAF,EAAsB+B,WAAtB,CAAkC,UAAlC,EAA8Ca,IAA9C,CAAmD,UAAnD,EAA+D,KAA/D;AACD;;;sCAEiB;AAChB5C,QAAE,mBAAF,EAAuB0C,KAAvB,CAA6B,KAA7B,EAAoC;AAClCC,kBAAU,IADwB;AAElCE,0BAAkB,IAFgB;AAGlCC,qBAAa,CAAC,CAAD,EAAI,CAAJ,CAHqB;AAIlCC,mBAAW;AACTC,gBAAM;AADG,SAJuB;AAOlCd,kBAAU;AACRY,uBAAa1B,WAAWC,KAAX,CAAiB,2BAAjB;AADL;AAPwB,OAApC;AAWD;;;mDAE8B;AAC7B,UAAI4B,cAAejD,EAAE,kBAAF,CAAnB;AACA,UAAIU,OAAO,IAAX;AACAuC,kBAAYC,KAAZ,CAAkB,YAAW;AAC3BxC,aAAKyC,cAAL;AACA,YAAIC,YAAYpD,EAAE,2BAAF,EAA+BC,MAA/B,GAAwC,gBAAxC,GAA2D,eAA3E;AACA,YAAIoD,mBAAJ,CAAc;AACZpC,mBAASgC,WADG;AAEZK,eAAKtD,EAAE,IAAF,EAAQuD,IAAR,CAAa,QAAb,CAFO;AAGZC,mBAAS,kBAHG;AAIZC,kBAAQL,SAJI;AAKZM,mBAAS,IALG;AAMZC,4BAAkB,IANN;AAOZC,sBAAY,kBAPA;AAQZC,sBAAY,sBAAW;AACrB,mBAAO,IAAP;AACD,WAVW;AAWZC,iBAAO,eAASA,MAAT,EAAgB;AACrBpD,iBAAKX,IAAL,CAAUgE,eAAV;AACD,WAbW;AAcZC,4BAAkB,0BAASC,WAAT,EAAsB;AACtC,gBAAIA,eAAe,iBAAnB,EAAsC;AACpChB,0BAAYL,IAAZ,CAAiB,UAAjB,EAA6B,IAA7B;AACA5C,gBAAE,iBAAF,EAAqB+B,WAArB,CAAiC,QAAjC;AACArB,mBAAKsB,YAAL,GAAoB,IAApB;AACA,kBAAGtB,KAAKX,IAAR,EAAc;AACZW,qBAAKX,IAAL,CAAUgE,eAAV;AACD;AACD,qBAAO,IAAP;AACD;AACD,mBAAO,KAAP;AACD;AAzBW,SAAd;AA2BD,OA9BD;AA+BD;;;qCAEgB;AACf,UAAIrD,OAAO,IAAX;AACA,aAAO;AACLgC,eAAO;AACLwB,oBAAU;AACRvB,sBAAU,IADF;AAERwB,4BAAgB,CAFR;AAGRC,4BAAgB,EAHR;AAIRF,sBAAU,IAJF;AAKRG,kCAAsB,IALd;AAMRtB,uBAAW;AACTC,oBAAM;AADG;AANH,WADL;AAWLsB,oBAAU;AACRC,uBAAW,CADH;AAERC,uBAAW,EAFH;AAGRC,4BAAgB;AAHR,WAXL;AAgBLC,iBAAO;AACL/B,sBAAU,IADL;AAEL+B,mBAAO,IAFF;AAGL3B,uBAAW;AACTC,oBAAM;AADG;AAHN,WAhBF;AAuBL2B,uBAAa;AACXhC,sBAAU,KADC;AAEXiC,4BAAgB,IAFL;AAGX7B,uBAAW;AACTC,oBAAM;AADG;AAHA,WAvBR;AA8BLV,yBAAe;AACbK,sBAAU,IADG;AAEbR,mCAAuB,IAFV;AAGbY,uBAAW;AACTC,oBAAM,KADG;AAET6B,wBAAU,kBAASC,IAAT,EAAe;AACvB,oBAAIA,IAAJ,EAAU;AACRpE,uBAAKG,WAAL;AACD,iBAFD,MAEO;AACLH,uBAAKyC,cAAL;AACD;AACF;AARQ;AAHE,WA9BV;AA4CL4B,0BAAgB;AACdpC,sBAAU,IADI;AAEdqC,mBAAO,IAFO;AAGdjC,uBAAW;AACTC,oBAAM,KADG;AAET6B,wBAAU,kBAASC,IAAT,EAAe;AACvB,oBAAIA,IAAJ,EAAU;AACRpE,uBAAKG,WAAL;AACD,iBAFD,MAEO;AACLH,uBAAKyC,cAAL;AACD;AACF;AARQ;AAHG,WA5CX;AA0DL8B,4BAAkB;AAChBtC,sBAAU;AADM,WA1Db;AA6DLuC,wBAAc;AACZvC,sBAAU;AADE;AA7DT,SADF;AAkELT,kBAAU;AACR6C,0BAAgB;AACdpC,sBAAUvB,WAAWC,KAAX,CAAiB,wBAAjB;AADI,WADR;AAIRiB,yBAAe;AACbK,sBAAUvB,WAAWC,KAAX,CAAiB,wCAAjB;AADG,WAJP;AAORqD,iBAAO;AACL/B,sBAAUvB,WAAWC,KAAX,CAAiB,oCAAjB;AADL,WAPC;AAUR4D,4BAAkB;AAChBtC,sBAAUvB,WAAWC,KAAX,CAAiB,iCAAjB;AADM,WAVV;AAaR6D,wBAAc;AACZvC,sBAAUvB,WAAWC,KAAX,CAAiB,qCAAjB;AADE;AAbN;AAlEL,OAAP;AAoFD;;;sCAEiBoB,M,EAAQ;AACxB,UAAIf,aAAa,WAAjB;AACA,UAAII,WAAWJ,WAAWG,IAAX,CAAgBY,MAAhB,CAAf;AACA,UAAIX,QAAJ,EAAc;AACZ,aAAKqD,eAAL;AACAnF,UAAE,2BAAF,EAA+B0C,KAA/B,CAAqC,QAArC;AACD,OAHD,MAGO;AACL,aAAK0C,uBAAL;AACApF,UAAE,mBAAF,EAAuB0C,KAAvB,CAA6B,QAA7B;AACD;AACF;;;uCAEkB;AACjB1C,QAAEqF,QAAF,EAAYC,KAAZ,CAAkB,YAAM;AACtB,YAAI,gBAAgBC,OAAOC,WAA3B,EAAwC;AACtCxF,YAAE,0BAAF,EAA8BuC,GAA9B,CAAkCgD,OAAOC,WAAzC;AACD;AACF,OAJD;AAKD;;;;;kBAjPkB1F,Q","file":"app/js/auth/register/index.js","sourcesContent":["module.exports = jQuery;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jQuery\"\n// module id = 0\n// module chunks = app/js/main app/js/v2/demo/index app/js/activity-manage/doc/index app/js/activity-manage/download/index app/js/activity-manage/flash/index app/js/activity-manage/homework/index app/js/activity-manage/ppt/index app/js/activity-manage/video/index app/js/article/detail/index app/js/attachment/index app/js/auth/captcha-modal/index app/js/auth/password-reset/index app/js/auth/register/index app/js/batch-upload/index app/js/card/card-receive/index app/js/card/index/index app/js/cashier/index app/js/cashier/modal/index app/js/classroom-manage/set-picture/index app/js/classroom-manage/student-expiryday/index app/js/classroom-manage/student-import/index app/js/classroom-manage/students-create/index app/js/classroom-manage/students-manage/index app/js/classroom/buy-modal/index app/js/classroom/index app/js/classroom/thread-form/index app/js/classroom/thread-show/index app/js/coin/invite-code/index app/js/course-chapter-manage/index app/js/course-manage-file/index/index app/js/course-manage/batch-create/index app/js/course-manage/lesson-manage/default/index app/js/course-manage/lesson-manage/normal/index app/js/course-manage/live-replay/upload/index app/js/course-manage/overview/index app/js/course-manage/student-import/index app/js/course/buy-modal/index app/js/course/thread-show/index app/js/courseset/show/index app/js/exporter/index app/js/group/index app/js/group/logo/index app/js/group/thread-add/index app/js/live-course/explore/index app/js/material-lib/index/index app/js/material-lib/share-history/index app/js/media-manage/index app/js/activity-manage/audio/index app/js/mobile-bind/index app/js/my/order-refund-apply/index app/js/my/order-refund/index app/js/my/order/index app/js/oauth2/create/index app/js/open-course-manage/add-material/index app/js/open-course-manage/lesson-modal/index app/js/open-course/index app/js/open-course/member-sms/index app/js/order/coupon-item/index app/js/order/create-sms/index app/js/order/create/index app/js/pay/select/index app/js/pay/show-mobile-modal/index app/js/player/index app/js/question-manage/form/index app/js/review/list/index app/js/search/index app/js/settings/avatar-crop-modal/index app/js/settings/bind-mobile/index app/js/settings/email/index app/js/settings/find_pay_password_by_sms/index app/js/settings/find-pay-password/index app/js/settings/password/index app/js/settings/pay-password-modal/index app/js/settings/pay-password/index app/js/settings/profile/index app/js/settings/reset-pay-password/index app/js/settings/security-questions/index app/js/settings/security/index app/js/settings/setup-password/index app/js/settings/setup/index app/js/settings/update-pay-password/index app/js/settings/user-profile/index app/js/subject/index app/js/task-manage/create/index app/js/task/plugin/note/index app/js/task/plugin/question/index app/js/testpaper-manage/create/index app/js/testpaper-manage/index app/js/testpaper-manage/questions/index app/js/testpaper/do-test/exercise/index app/js/testpaper/do-test/normal/index app/js/testpaper/result/index app/js/thread/user-info-modal/index app/js/user/fill-info/index app/js/message/show/index","import Register from './register';\nnew Register();\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/auth/register/index.js","import SmsSender from 'app/common/widget/sms-sender';\nimport Drag from 'app/common/drag';\n\nexport default class Register {\n  constructor() {\n    this.drag = $('#drag-btn').length ? new Drag($('#drag-btn'), $('.js-jigsaw'), {\n      limitType: 'web_register'\n    }) : null;\n    this.setValidateRule();\n    this.dragEvent();\n    this.initValidator();\n    this.inEventMobile();\n    this.initMobileMsgVeriCodeSendBtn();\n    this.initFieldVisitId();\n  }\n\n  dragEvent() {\n    let self = this;\n    if (this.drag) {\n      this.drag.on('success', function(token){\n        self._smsBtnable();\n      });\n    }\n  }\n\n  setValidateRule() {\n    $.validator.addMethod('spaceNoSupport', function (value, element) {\n      return value.indexOf(' ') < 0;\n    }, $.validator.format(Translator.trans('validate.have_spaces')));\n  }\n\n  initValidator() {\n    let self = this;\n    $('#register-form').validate(this._validataRules());\n    $.validator.addMethod('email_or_mobile_check', function(value, element, params) {\n      let reg_email = /^([a-zA-Z0-9_\\.\\-\\+])+\\@(([a-zA-Z0-9\\-])+\\.)+([a-zA-Z0-9]{2,4})+$/;\n      var reg_mobile = /^1\\d{10}$/;\n      var result = false;\n      var isEmail = reg_email.test(value);\n      var isMobile = reg_mobile.test(value);\n      if (isMobile) {\n        $('.email_mobile_msg').removeClass('hidden');\n        if (!self.captchEnable) {\n          $('.js-drag-jigsaw').addClass('hidden');\n        }\n      } else {\n        $('.email_mobile_msg').addClass('hidden');\n        $('.js-drag-jigsaw').removeClass('hidden');\n      }\n      if (isEmail || isMobile) {\n        result = true;\n      }\n      $.validator.messages.email_or_mobile_check = Translator.trans('validate.mobile_or_email_message');\n      return this.optional(element) || result;\n    }, Translator.trans('validate.email_or_mobile_check.message'));\n  }\n\n  inEventMobile() {\n    $('#register_emailOrMobile').blur(() => {\n      let emailOrMobile = $('#register_emailOrMobile').val();\n      this.emSmsCodeValidate(emailOrMobile);\n    });\n\n    $('#register_mobile').blur(() => {\n      let mobile = $('#register_mobile').val();\n      this.emSmsCodeValidate(mobile);\n    });\n  }\n\n  initDragCaptchaCodeRule() {\n    if ($('.js-drag-img').length) {\n      $('[name=\"dragCaptchaToken\"]').rules('add', {\n        required: true,\n        messages: {\n          required: Translator.trans('auth.register.drag_captcha_tips')\n        }\n      });\n    }\n  }\n\n  _smsBtnDisable() {\n    $('.js-sms-send-btn').addClass('disabled').attr('disabled', true);\n  }\n\n  _smsBtnable() {\n    $('.js-sms-send-btn').removeClass('disabled').attr('disabled', false);\n  }\n\n  initSmsCodeRule() {\n    $('[name=\"sms_code\"]').rules('add', {\n      required: true,\n      unsigned_integer: true,\n      rangelength: [6, 6],\n      es_remote: {\n        type: 'get',\n      },\n      messages: {\n        rangelength: Translator.trans('validate.sms_code.message')\n      }\n    });\n  }\n\n  initMobileMsgVeriCodeSendBtn() {\n    let $smsSendBtn =  $('.js-sms-send-btn');\n    let self = this;\n    $smsSendBtn.click(function() {\n      self._smsBtnDisable();\n      let fieldName = $('[name=\\'verifiedMobile\\']').length ? 'verifiedMobile' : 'emailOrMobile';\n      new SmsSender({\n        element: $smsSendBtn,\n        url: $(this).data('smsUrl'),\n        smsType: 'sms_registration',\n        dataTo: fieldName,\n        captcha: true,\n        captchaValidated: true,\n        captchaNum: 'dragCaptchaToken',\n        preSmsSend: function() {\n          return true;\n        },\n        error: function(error) {\n          self.drag.initDragCaptcha();\n        },\n        additionalAction: function(ackResponse) {\n          if (ackResponse == 'captchaRequired') {\n            $smsSendBtn.attr('disabled', true);\n            $('.js-drag-jigsaw').removeClass('hidden');\n            self.captchEnable = true;\n            if(self.drag) {\n              self.drag.initDragCaptcha();\n            }\n            return true;\n          }\n          return false;\n        }\n      });\n    });\n  }\n\n  _validataRules() {\n    let self = this;\n    return {\n      rules: {\n        nickname: {\n          required: true,\n          byte_minlength: 4,\n          byte_maxlength: 18,\n          nickname: true,\n          chinese_alphanumeric: true,\n          es_remote: {\n            type: 'get',\n          }\n        },\n        password: {\n          minlength: 5,\n          maxlength: 20,\n          spaceNoSupport: true,\n        },\n        email: {\n          required: true,\n          email: true,\n          es_remote: {\n            type: 'get'\n          }\n        },\n        invitedCode: {\n          required: false,\n          reg_inviteCode: true,\n          es_remote: {\n            type: 'get'\n          }\n        },\n        emailOrMobile: {\n          required: true,\n          email_or_mobile_check: true,\n          es_remote: {\n            type: 'get',\n            callback: function(bool) {\n              if (bool) {\n                self._smsBtnable();\n              } else {\n                self._smsBtnDisable();\n              }\n            }\n          }\n        },\n        verifiedMobile: {\n          required: true,\n          phone: true,\n          es_remote: {\n            type: 'get',\n            callback: function(bool) {\n              if (bool) {\n                self._smsBtnable();\n              } else {\n                self._smsBtnDisable();\n              }\n            }\n          }\n        },\n        dragCaptchaToken: {\n          required: true,\n        },\n        agree_policy: {\n          required: true,\n        },\n      },\n      messages: {\n        verifiedMobile: {\n          required: Translator.trans('validate.phone.message'),\n        },\n        emailOrMobile: {\n          required: Translator.trans('validate.phone_and_email_input.message'),\n        },\n        email: {\n          required: Translator.trans('validate.valid_email_input.message'),\n        },\n        dragCaptchaToken: {\n          required: Translator.trans('auth.register.drag_captcha_tips')\n        },\n        agree_policy: {\n          required: Translator.trans('validate.valid_policy_input.message'),\n        },\n      },\n    };\n  }\n\n  emSmsCodeValidate(mobile) {\n    let reg_mobile = /^1\\d{10}$/;\n    let isMobile = reg_mobile.test(mobile);\n    if (isMobile) {\n      this.initSmsCodeRule();\n      $('[name=\"dragCaptchaToken\"]').rules('remove');\n    } else {\n      this.initDragCaptchaCodeRule();\n      $('[name=\"sms_code\"]').rules('remove');\n    }\n  }\n\n  initFieldVisitId() {\n    $(document).ready(() => {\n      if ('undefined' !== window._VISITOR_ID) {\n        $('[name=\"registerVisitId\"]').val(window._VISITOR_ID);\n      }\n    })\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/auth/register/register.js"],"sourceRoot":""}