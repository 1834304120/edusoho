{"version":3,"sources":["webpack:///./app/Resources/static-src/app/js/open-course/header/index.js","webpack:///./app/Resources/static-src/app/js/open-course/header/course-ad.js","webpack:///./app/Resources/static-src/app/js/open-course/header/open-course-player.js","webpack:///./app/Resources/static-src/common/video-player-judge.js"],"names":["$","length","openCoursePlayer","OpenCoursePlayer","url","data","element","CourseAd","courseUrl","$element","init","html","get","then","console","log","map","item","template","id","cover","title","find","ua","navigator","userAgent","toLowerCase","test","parent","middle","isWxPreviewType","isWxAndroidBrowser","document","getElementById","contentWindow","style","display","on","modal","backdrop","player","lesson","courseAd","initEvent","showPlayer","replay","event","onLiveVideoPlay","mediaError","show","hide","removeClass","mediaSourceActionsMap","onIframe","onVideo","caller","mediaSource","bind","undefined","type","onSWF","$ifrimeContent","empty","mediaUri","flashTip","convertStatus","storage","Translator","trans","playerUrl","courseId","videoPlay","swfobject","hasFlashPlayerVersion","$swfContent","removeSWF","embedSWF","wmode","allowFullScreen","window","location","reload","e","$target","currentTarget","replayStatus","referer","frames","BalloonVideoPlayer","$videoContent","messenger","EsMessenger","name","project","children","getPlayer","onPlayEnd","showADModal","flag","supportsNativeHls","video","createElement","canPlay","some","canPlayType","canItPlay","isIE","Browser","ie9","ie10","ie11","edge","getSupportedPlayer","MediaSource"],"mappings":"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","file":"app/js/open-course/header/index.js","sourcesContent":["import OpenCoursePlayer from './open-course-player';\nimport swfobject from 'es-swfobject';\nimport { isMobileDevice } from 'common/utils';\n\nif ($('#firstLesson').length > 0) {\n  let openCoursePlayer = new OpenCoursePlayer({\n    url: $('#firstLesson').data('url'),\n    element: '.open-course-views',\n  });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/open-course/header/index.js","class CourseAd {\n  constructor({ element, courseUrl }) {\n    this.$element = $(element);\n    this.courseUrl = courseUrl;\n    this.init();\n  }\n\n  init() {\n    let html = '';\n\n    $.get(this.courseUrl).then((data) => {\n      console.log(data);\n      data.map((item) => {\n        html =  html + this.template(item.id, item.cover, item.title);\n      });\n\n      this.$element.find('.modal-body').html(html);\n    });\n  }\n\n  isWxAndroidBrowser() {\n    let ua = navigator.userAgent.toLowerCase();\n    return /android/.test(ua) && /micromessenger/i.test(ua);\n  }\n\n  isWxPreviewType () {\n    return this.$element.parent('.js-open-course-wechat-preview').length > 0;\n  }\n\n  template(id, cover, title) {\n    return `<div class=\"modal-img\">\n        <a href=\"/course_set/${id}\">\n          <img class=\"img-responsive\" src=\"${cover.middle}\" alt=\"\">\n        </a>\n        <div class=\"title\"><a class=\"link-dark\" href=\"/course_set/${id}\">${title}</a></div>\n      </div>`;\n  }\n\n  show() {\n    if (this.isWxPreviewType()) {\n      return;\n    }\n\n    if (this.isWxAndroidBrowser()) {\n      document.getElementById('viewerIframe').contentWindow.document.getElementById('lesson-player').style.display = 'none';\n\n      this.$element.on('hide.bs.modal', () => {\n        document.getElementById('viewerIframe').contentWindow.document.getElementById('lesson-player').style.display = 'block';\n      });\n    }\n\n    this.$element.modal({\n      backdrop: false\n    });\n  }\n\n  hide() {\n    this.$element.modal('hide');\n  }\n}\n\nexport default CourseAd;\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/open-course/header/course-ad.js","import EsMessenger from 'app/common/messenger';\nimport swfobject from 'es-swfobject';\nimport { getSupportedPlayer } from 'common/video-player-judge';\nimport CourseAd from './course-ad';\n\nclass OpenCoursePlayer {\n  constructor({\n    url,\n    element,\n  }) {\n    this.url = url;\n    this.$element = $(element);\n\n    this.player = null;\n    this.lesson = null;\n    this.courseAd = null;\n\n    this.init();\n    this.initEvent();\n  }\n\n  init() {\n    this.showPlayer();\n  }\n\n  initEvent() {\n    this.$element.on('click', '.js-player-replay', event => this.replay(event));\n    this.$element.on('click', '.js-live-video-replay-btn', event => this.onLiveVideoPlay(event));\n  }\n\n  showPlayer() {\n    $.get(this.url, (lesson) => {\n      console.log(this.url, lesson);\n      if (lesson.mediaError) {\n        $('#media-error-dialog').show();\n        $('#media-error-dialog').find('.modal-body .media-error').html(lesson.mediaError);\n        return;\n      }\n      $('#media-error-dialog').hide();\n      this.lesson = lesson;\n      $('.js-live-video-replay-btn').removeClass('hidden');\n\n      let mediaSourceActionsMap = {\n        'iframe': this.onIframe,\n        'self': this.onVideo\n      };\n\n      let caller = mediaSourceActionsMap[lesson.mediaSource] ? mediaSourceActionsMap[lesson.mediaSource].bind(this) : undefined;\n\n      if (caller === undefined && (lesson.type == 'video' || lesson.type == 'audio')) {\n        caller = this.onSWF.bind(this);\n      }\n\n      if (caller === undefined) {\n        return;\n      }\n\n      caller(this);\n\n    });\n  }\n\n  onIframe() {\n    let $ifrimeContent = $('#lesson-preview-iframe');\n    $ifrimeContent.empty();\n\n    var html = `<iframe class=\"embed-responsive-item\" src=\"${this.lesson.mediaUri}\" style=\"position:absolute; left:0; top:0; height:100%; width:100%; border:0px;\" scrolling=\"no\"></iframe>`;\n\n    $ifrimeContent.html(html);\n    $ifrimeContent.show();\n  }\n\n  onVideo() {\n    if (getSupportedPlayer() === 'flash') {\n      this.flashTip();\n      return;\n    }\n    let lesson = this.lesson;\n\n    if (lesson.type == 'video' || lesson.type == 'audio') {\n      if (lesson.convertStatus != 'success' && lesson.storage == 'cloud') {\n        $('#media-error-dialog').show();\n        $('#media-error-dialog').find('.modal-body .media-error').html(Translator.trans('open_course.converting_hint'));\n        return;\n      }\n      let playerUrl = `/open/course/${lesson.courseId}/lesson/${lesson.id}/player`;\n\n      this.videoPlay(playerUrl);\n\n    } else {\n      return;\n    }\n  }\n\n  onSWF() {\n    if (!swfobject.hasFlashPlayerVersion('11')) {\n      this.flashTip();\n      return;\n    }\n    let lesson = this.lesson;\n    let $swfContent = $('#lesson-preview-swf-player');\n\n    swfobject.removeSWF('lesson-preview-swf-player');\n    $swfContent.html('<div id=\"lesson-swf-player\"></div>');\n    swfobject.embedSWF(lesson.mediaUri,\n      'lesson-swf-player', '100%', '100%', '9.0.0', null, null, {\n        wmode: 'opaque',\n        allowFullScreen: 'true'\n      });\n    $swfContent.show();\n  }\n\n  replay() {\n    if (!this.player) {\n      window.location.reload();\n    } else {\n      this.player.replay();\n      this.courseAd.hide();\n    }\n  }\n\n  onLiveVideoPlay(e) {\n    this.$element.find('.js-live-header-mask').hide();\n\n    let $target = $(e.currentTarget);\n\n    let lesson = this.lesson;\n\n    if (lesson.mediaError) {\n      $('#media-error-dialog').show();\n      $('#media-error-dialog').find('.modal-body .media-error').html(lesson.mediaError);\n      return;\n    }\n\n    $('#media-error-dialog').hide();\n\n    if (lesson.type == 'liveOpen' && lesson.replayStatus == 'videoGenerated') {\n      if ((lesson.convertStatus != 'success' && lesson.storage == 'cloud')) {\n        $('#media-error-dialog').show();\n        $('#media-error-dialog').find('.modal-body .media-error').html(Translator.trans('open_course.converting_hint'));\n        return;\n      }\n\n      let referer = $target.data('referer');\n      let playerUrl = `/open/course/${lesson.courseId}/lesson/${lesson.id}/player?referer=${referer}`;\n\n      this.videoPlay(playerUrl);\n\n    } else {\n      return;\n    }\n  }\n\n  getPlayer() {\n    return window.frames['viewerIframe'].window.BalloonVideoPlayer ||\n           window.frames['viewerIframe'].window.player;\n  }\n\n  videoPlay(playerUrl) {\n    let $videoContent = $('#lesson-preview-player');\n    $videoContent.html('');\n\n    let html = `<iframe \n      class=\"embed-responsive-item\" \n      src=\"${playerUrl}\" \n      name=\"viewerIframe\" \n      id=\"viewerIframe\" \n      width=\"100%\" \n      allowfullscreen \n      webkitallowfullscreen \n      height=\"100%\"\" \n      style=\"border:0px;position:absolute; left:0; top:0;\"></iframe>`;\n\n    $videoContent.html(html).show();\n\n    let messenger = new EsMessenger({\n      name: 'parent',\n      project: 'PlayerProject',\n      children: [document.getElementById('viewerIframe')],\n      type: 'parent'\n    });\n\n    messenger.on('ready', () => {\n      // @TODO 不清楚这边有什么用\n      let player = this.getPlayer();\n      this.player = player;\n      console.log('player', player);\n    });\n\n    messenger.on('ended', () => {\n      console.log('ended');\n      this.onPlayEnd();\n    });\n  }\n\n  onPlayEnd() {\n    this.showADModal();\n  }\n\n  showADModal() {\n    if (this.courseAd) {\n      this.courseAd.show();\n      return;\n    }\n\n    this.courseAd = new CourseAd({\n      element: '#open-course-ad-modal',\n      courseUrl: this.$element.data('get-recommend-course-url')\n    });\n    this.courseAd.show();\n  }\n\n  flashTip(flag) {\n    const html = `\n    <div class=\"alert alert-warning alert-dismissible fade in\" role=\"alert\">\n      <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\">\n      <span aria-hidden=\"true\">×</span>\n      </button>\n      ${Translator.trans('site.flash_not_install_hint')}\n    </div>`;\n    $('#lesson-preview-swf-player').html(html).show();\n  }\n\n}\n\nexport default OpenCoursePlayer;\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/open-course/header/open-course-player.js","const supportsNativeHls = () => {\n  const video = document.createElement('video');\n\n  // HLS manifests can go by many mime-types\n  const canPlay = [\n    // Apple santioned\n    'application/vnd.apple.mpegurl',\n    // Apple sanctioned for backwards compatibility\n    'audio/mpegurl',\n    // Very common\n    'audio/x-mpegurl',\n    // Very common\n    'application/x-mpegurl',\n    // Included for completeness\n    'video/x-mpegurl',\n    'video/mpegurl',\n    'application/mpegurl',\n  ];\n\n  return canPlay.some(canItPlay => (/maybe|probably/i).test(video.canPlayType(canItPlay)));\n};\n\nconst isIE = function() {\n  const Browser = {};\n  Browser.ie9 = /MSIE\\s+9.0/i.test(navigator.userAgent);\n  Browser.ie10 = /MSIE\\s+10.0/i.test(navigator.userAgent);\n  Browser.ie11 = (/Trident\\/7\\./).test(navigator.userAgent);\n  Browser.edge = /Edge\\/13./i.test(navigator.userAgent);\n  if (Browser.ie9 || Browser.ie10 || Browser.ie11 || Browser.edge) {\n    return true;\n  }\n};\n\nexport const getSupportedPlayer = () => {\n  if (supportsNativeHls()) {\n    return 'native';\n  } else if (window.MediaSource) {\n    return 'hls';\n  } else if (isIE()) {\n    return 'flash';\n  }\n  return false;\n};\n\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/common/video-player-judge.js"],"sourceRoot":""}