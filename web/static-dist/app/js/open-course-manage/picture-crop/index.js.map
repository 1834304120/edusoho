{"version":3,"sources":["webpack:///./app/Resources/static-src/app/js/open-course-manage/picture-crop/index.js","webpack:///./node_modules/es-jcrop/css/Jcrop.min.css?2518","webpack:///./node_modules/es-jcrop/css/Jcrop.min.css","webpack:///./app/Resources/static-src/app/common/local-image/crop.js"],"names":["LocalImageCrop","cropImg","saveBtn","selectBtn","group","imgs","large","middle","small","props","lastFile","uploadInput","modal","init","initImage","imageCrop","initEvent","$sourceImg","imageAttr","JSON","parse","localStorage","getItem","$","attr","src","width","height","removeItem","on","saveEvent","event","selectEvent","stopPropagation","$this","currentTarget","console","log","crop","post","button","click","EsImageCrop","element","cropedWidth","cropedHeight","files","afterCrop","res","cropOptions","fromData","FormData","$modal","$input","append","data","file","uploadImage","resolve","reject","ajax","url","type","cache","processData","contentType","done","cropImage","saveImage","images","image","cd","message","Translator","trans","error","always","val","then","catch"],"mappings":"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","file":"app/js/open-course-manage/picture-crop/index.js","sourcesContent":["import LocalImageCrop from  'app/common/local-image/crop';\n\nnew LocalImageCrop({\n  cropImg: '#open-course-crop',\n  saveBtn: '#save-btn',\n  selectBtn: '#select-btn',\n  group: 'course',\n  imgs: {\n    large: [480, 270],\n    middle: [304, 171],\n    small: [96, 54],\n  }\n});\n\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/open-course-manage/picture-crop/index.js","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../css-loader/index.js!./Jcrop.min.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {\"insertAt\":\"top\",\"hmr\":true}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../css-loader/index.js!./Jcrop.min.css\", function() {\n\t\t\tvar newContent = require(\"!!../../css-loader/index.js!./Jcrop.min.css\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/style-loader?insertAt=top!./node_modules/css-loader!./node_modules/es-jcrop/css/Jcrop.min.css\n// module id = c962afacd3de715604c1\n// module chunks = app/js/classroom-manage/set-picture-crop/index app/js/courseset-manage/cover-crop/index app/js/group/background-crop/index app/js/group/logo-crop/index app/js/open-course-manage/picture-crop/index app/js/settings/avatar-crop-modal/index app/js/settings/avatar-crop/index app/js/settings/profile-avatar-crop-modal/index","exports = module.exports = require(\"../../css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \"/*! Jcrop.min.css v2.0.4 - build: 20151117\\n *  Copyright 2008-2015 Tapmodo Interactive LLC\\n *  Free software under MIT License\\n **/\\n\\n.jcrop-active{direction:ltr;text-align:left;box-sizing:border-box;-ms-touch-action:none}.jcrop-dragging{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.jcrop-selection{z-index:2}.jcrop-selection.jcrop-current{z-index:4}.jcrop-border{background:#fff url(\" + require(\"./Jcrop.gif\") + \");line-height:1px!important;font-size:0!important;overflow:hidden;position:absolute;filter:alpha(opacity=50)!important;opacity:.5!important}.jcrop-border.ord-w,.jcrop-border.ord-e,.jcrop-border.ord-n{top:0}.jcrop-border.ord-n,.jcrop-border.ord-s{width:100%;height:1px!important}.jcrop-border.ord-w,.jcrop-border.ord-e{height:100%;width:1px!important}.jcrop-border.ord-e{right:-1px}.jcrop-border.ord-n{top:-1px}.jcrop-border.ord-w{left:-1px}.jcrop-border.ord-s{bottom:-1px}.jcrop-selection{position:absolute}.jcrop-box{z-index:2;display:block;background:0 0;border:0;padding:0;margin:0;font-size:0}.jcrop-box:hover{background:0 0}.jcrop-box:active{background:0 0}.jcrop-box:focus{outline:1px rgba(128,128,128,.65) dotted}.jcrop-active,.jcrop-box{position:relative}.jcrop-box{width:100%;height:100%;cursor:move}.jcrop-handle{z-index:4;background-color:rgba(49,28,28,.58);border:1px #eee solid;width:9px;height:9px;font-size:0;position:absolute;filter:alpha(opacity=80)!important;opacity:.8!important}.jcrop-handle.ord-n{left:50%;margin-left:-5px;margin-top:-5px;top:0;cursor:n-resize}.jcrop-handle.ord-s{bottom:0;left:50%;margin-bottom:-5px;margin-left:-5px;cursor:s-resize}.jcrop-handle.ord-e{margin-right:-5px;margin-top:-5px;right:0;top:50%;cursor:e-resize}.jcrop-handle.ord-w{left:0;margin-left:-5px;margin-top:-5px;top:50%;cursor:w-resize}.jcrop-handle.ord-nw{left:0;margin-left:-5px;margin-top:-5px;top:0;cursor:nw-resize}.jcrop-handle.ord-ne{margin-right:-5px;margin-top:-5px;right:0;top:0;cursor:ne-resize}.jcrop-handle.ord-se{bottom:0;margin-bottom:-5px;margin-right:-5px;right:0;cursor:se-resize}.jcrop-handle.ord-sw{bottom:0;left:0;margin-bottom:-5px;margin-left:-5px;cursor:sw-resize}.jcrop-touch .jcrop-handle{z-index:4;background-color:rgba(49,28,28,.58);border:1px #eee solid;width:18px;height:18px;font-size:0;position:absolute;filter:alpha(opacity=80)!important;opacity:.8!important}.jcrop-touch .jcrop-handle.ord-n{left:50%;margin-left:-10px;margin-top:-10px;top:0;cursor:n-resize}.jcrop-touch .jcrop-handle.ord-s{bottom:0;left:50%;margin-bottom:-10px;margin-left:-10px;cursor:s-resize}.jcrop-touch .jcrop-handle.ord-e{margin-right:-10px;margin-top:-10px;right:0;top:50%;cursor:e-resize}.jcrop-touch .jcrop-handle.ord-w{left:0;margin-left:-10px;margin-top:-10px;top:50%;cursor:w-resize}.jcrop-touch .jcrop-handle.ord-nw{left:0;margin-left:-10px;margin-top:-10px;top:0;cursor:nw-resize}.jcrop-touch .jcrop-handle.ord-ne{margin-right:-10px;margin-top:-10px;right:0;top:0;cursor:ne-resize}.jcrop-touch .jcrop-handle.ord-se{bottom:0;margin-bottom:-10px;margin-right:-10px;right:0;cursor:se-resize}.jcrop-touch .jcrop-handle.ord-sw{bottom:0;left:0;margin-bottom:-10px;margin-left:-10px;cursor:sw-resize}.jcrop-dragbar{font-size:0;position:absolute}.jcrop-dragbar.ord-n,.jcrop-dragbar.ord-s{height:9px!important;width:100%}.jcrop-dragbar.ord-e,.jcrop-dragbar.ord-w{top:0;height:100%;width:9px!important}.jcrop-dragbar.ord-n{margin-top:-5px;cursor:n-resize;top:0}.jcrop-dragbar.ord-s{bottom:0;margin-bottom:-5px;cursor:s-resize}.jcrop-dragbar.ord-e{margin-right:-5px;right:0;cursor:e-resize}.jcrop-dragbar.ord-w{margin-left:-5px;cursor:w-resize}.jcrop-shades{position:relative;top:0;left:0}.jcrop-shades div{cursor:crosshair}.jcrop-noresize .jcrop-dragbar,.jcrop-noresize .jcrop-handle{display:none}.jcrop-selection.jcrop-nodrag .jcrop-box,.jcrop-nodrag .jcrop-shades div{cursor:default}.jcrop-light .jcrop-border{background:#fff;filter:alpha(opacity=70)!important;opacity:.7!important}.jcrop-light .jcrop-handle{background-color:#000;border-color:#fff}.jcrop-dark .jcrop-border{background:#000;filter:alpha(opacity=70)!important;opacity:.7!important}.jcrop-dark .jcrop-handle{background-color:#fff;border-color:#000}.solid-line .jcrop-border{background:#fff}.jcrop-thumb{position:absolute;overflow:hidden;z-index:5}.jcrop-active img,.jcrop-thumb img,.jcrop-thumb canvas{min-width:none;min-height:none;max-width:none;max-height:none}.jcrop-hl-active .jcrop-border{filter:alpha(opacity=20)!important;opacity:.2!important}.jcrop-hl-active .jcrop-handle{filter:alpha(opacity=10)!important;opacity:.1!important}.jcrop-hl-active .jcrop-selection:hover{}.jcrop-hl-active .jcrop-selection:hover .jcrop-border{background-color:#ccc;filter:alpha(opacity=50)!important;opacity:.5!important}.jcrop-hl-active .jcrop-selection.jcrop-current .jcrop-border{background:gray url(\" + require(\"./Jcrop.gif\") + \");opacity:.35!important;filter:alpha(opacity=35)!important}.jcrop-hl-active .jcrop-selection.jcrop-current .jcrop-handle{filter:alpha(opacity=30)!important;opacity:.3!important}.jcrop-hl-active .jcrop-selection.jcrop-focus .jcrop-border{background:url(\" + require(\"./Jcrop.gif\") + \");opacity:.65!important;filter:alpha(opacity=65)!important}.jcrop-hl-active .jcrop-selection.jcrop-focus .jcrop-handle{filter:alpha(opacity=60)!important;opacity:.6!important}button.jcrop-box{background:0 0}\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader!./node_modules/es-jcrop/css/Jcrop.min.css\n// module id = c962afacd3de715604c6\n// module chunks = app/js/classroom-manage/set-picture-crop/index app/js/courseset-manage/cover-crop/index app/js/group/background-crop/index app/js/group/logo-crop/index app/js/open-course-manage/picture-crop/index app/js/settings/avatar-crop-modal/index app/js/settings/avatar-crop/index app/js/settings/profile-avatar-crop-modal/index","import EsImageCrop from 'common/es-image-crop';\n\nclass LocalImageCrop {\n  constructor(props) {\n    this.cropImg = props.cropImg;\n    this.saveBtn = props.saveBtn;\n    this.selectBtn = props.selectBtn;\n    this.imgs = props.imgs;\n    this.group = props.group;\n    this.lastFile = {};\n    this.uploadInput = props.uploadInput || '.js-upload-input';\n    this.modal = props.modal || '#modal';\n\n    this.init();\n  }\n\n  init() {\n    this.initImage();\n\n    let imageCrop = this.imageCrop();\n    this.initEvent(imageCrop);\n  }\n\n  initImage($sourceImg) {\n    let imageAttr = JSON.parse(localStorage.getItem('crop_image_attr'));\n\n    $(this.cropImg).attr({\n      'src': imageAttr.src,\n      'width': imageAttr.width,\n      'height': imageAttr.height,\n      'data-natural-width': imageAttr['natural-width'],\n      'data-natural-height': imageAttr['natural-height'],\n    });\n\n    localStorage.removeItem('crop_image_attr');\n  }\n\n  initEvent(imageCrop) {\n    $(this.saveBtn).on('click', event => this.saveEvent(event, imageCrop));\n    $(this.selectBtn).on('click', event => this.selectEvent(event));\n  }\n\n  saveEvent(event, imageCrop) {\n    event.stopPropagation();\n    const $this = $(event.currentTarget);\n    console.log('start crop');\n    imageCrop.crop({\n      imgs: this.imgs,\n      post: false\n    });\n    $this.button('loading');\n  }\n\n  selectEvent(event) {\n    $(this.uploadInput).click();\n  }\n\n  imageCrop() {\n    let imageCrop = new EsImageCrop({\n      element: this.cropImg,\n      cropedWidth: this.imgs.large[0],\n      cropedHeight: this.imgs.large[1],\n      group: this.group\n    });\n    this.lastFile = $(this.uploadInput)[0].files[0];\n    imageCrop.afterCrop = (res) => {\n      this.afterCrop(res);\n    };\n\n    return imageCrop;\n  }\n\n  afterCrop(cropOptions) {\n    let fromData = new FormData();\n    let $modal =  $(this.modal);\n    let $input = $(this.uploadInput);\n\n    fromData.append('token', $input.data('token'));\n    const file = $input[0].files[0] ? $input[0].files[0]: this.lastFile;\n    fromData.append('file', file);\n\n    let uploadImage = function() {\n      return new Promise(function(resolve, reject) {\n        $.ajax({\n          url: $input.data('fileUpload'),\n          type: 'POST',\n          cache: false,\n          data: fromData,\n          processData: false,\n          contentType: false,\n        }).done(function(data) {\n          resolve(data);\n        });\n      });\n    };\n\n    let cropImage = function(res) {\n      return new Promise(function(resolve, reject) {\n        $.post($input.data('crop'), cropOptions, function(data) {\n          resolve(data);\n        });\n      });\n    };\n\n    let saveImage = function(res) {\n      return new Promise(function(resolve, reject) {\n        $.post($input.data('saveUrl'), { images: res }, function(data) {\n          if (data.image) {\n            $($input.data('targetImg')).attr('src', data.image);\n            cd.message({ type: 'success', message: Translator.trans('site.upload_success_hint') });\n          }\n        }).error(function() {\n          cd.message({ type: 'danger', message: Translator.trans('site.upload_fail_retry_hint') });\n        }).always(function() {\n          $input.val('');\n          $modal.modal('hide');\n        });\n      });\n    };\n\n    uploadImage().then(function(res) {\n      return cropImage(res);\n\n    }).then(function(res) {\n      return saveImage(res);\n\n    }).catch(function(res) {\n      console.log(res);\n    });\n\n  }\n}\n\nexport default LocalImageCrop;\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/common/local-image/crop.js"],"sourceRoot":""}