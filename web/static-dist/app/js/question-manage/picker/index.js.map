{"version":3,"sources":["webpack:///./app/Resources/static-src/app/js/question-manage/picker/index.js","webpack:///./app/Resources/static-src/app/common/component/question-subjective/index.js","webpack:///./app/Resources/static-src/app/common/component/question-picker/index.js"],"names":["QuestionPicker","$","BatchSelect","SelectLinkage","questionSubjectiveRemask","$element","hasSubjective","html","$subjectiveRemask","contents","find","each","type","data","console","log","length","Translator","trans","removeClass","$questionPickerBody","$questionAppendForm","$questionPickerModal","closest","_initEvent","on","searchQuestion","event","pickItem","questionPreview","pagination","$batchSelectSave","window","parent","document","batchSelectSave","$btn","currentTarget","get","attr","preventDefault","$this","$form","serialize","$target","replace","parseInt","questionId","questionIds","push","pickItemPost","url","post","replaceWith","remove","$tbody","append","trigger","_refreshSeqs","modal","open","show","index","item","seq","$tr","hasClass","val"],"mappings":"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","file":"app/js/question-manage/picker/index.js","sourcesContent":["import QuestionPicker from '../../../common/component/question-picker';\nimport BatchSelect from '../../../common/widget/batch-select';\nimport SelectLinkage from 'app/js/question-manage/widget/select-linkage.js';\n\nnew QuestionPicker($('#question-picker-body'), $('#question-checked-form'));\nnew BatchSelect($('#question-picker-body'));\n\nnew SelectLinkage($('[name=\"courseId\"]'),$('[name=\"lessonId\"]'));\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/question-manage/picker/index.js","export let questionSubjectiveRemask = ($element) => {\n  let hasSubjective = false;\n  let html = '';\n  const $subjectiveRemask = $('#task-create-content-iframe').contents().find('.js-subjective-remask');\n\n  $element.find('tbody tr').each(function() {\n    let type = $(this).data('type');\n    console.log(type);\n    if (type == 'essay') {\n      hasSubjective = true;\n    }\n  });\n  console.log(hasSubjective);\n  if(hasSubjective || $element.find('tbody tr').length == 0) {\n    $subjectiveRemask.html('');\n    return;\n  }\n\n  console.log($subjectiveRemask);\n\n  if($subjectiveRemask.data('type') == 'homework') {\n    html = Translator.trans('activity.homework_manage.objective_question_hint');\n  }\n  else {\n    html = Translator.trans('activity.homework_manage.pass_objective_question_hint');\n  }\n  $subjectiveRemask.html(html).removeClass('hidden');\n};\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/common/component/question-subjective/index.js","import { questionSubjectiveRemask } from '../question-subjective';\n\nexport default class QuestionPicker {\n  constructor($questionPickerBody, $questionAppendForm) {\n    this.$questionPickerBody = $questionPickerBody;\n    this.$questionPickerModal = this.$questionPickerBody.closest('.modal');\n    this.$questionAppendForm = $questionAppendForm;\n    this._initEvent();\n  }\n\n  _initEvent() { \n    this.$questionPickerBody.find('[data-role=\"search-btn\"]').on('click', event=>this.searchQuestion(event));\n    this.$questionPickerBody.find('[data-role=\"picked-item\"]').on('click', event=>this.pickItem(event));\n    this.$questionPickerBody.find('[data-role=\"preview-btn\"]').on('click', event=>this.questionPreview(event));\n    this.$questionPickerBody.find('.pagination a').on('click', event=>this.pagination(event));\n\n    let $batchSelectSave = $('[data-role=\"batch-select-save\"]',window.parent.document);\n    $batchSelectSave.on('click',event=>this.batchSelectSave(event));\n  }\n\n\n  pagination(event) {\n    let $btn  =  $(event.currentTarget);\n    $.get($btn.attr('href'),html=> {\n      this.$questionPickerModal.html(html);\n    });\n    return false;\n  }\n\n  searchQuestion(event) {\n    event.preventDefault();\n    let $this = $(event.currentTarget);\n    let $form = $this.closest('form');\n    $.get($form.attr('action'), $form.serialize(), html => {\n      this.$questionPickerModal.html(html);\n    });\n  }\n\n  pickItem(event) {\n    let $target = $(event.currentTarget);\n    let replace = parseInt($target.data('replace'));\n    let questionId = $target.data('questionId');\n    let questionIds = [];\n    questionIds.push(questionId);\n    $target.attr('disabled',true);\n    this.pickItemPost($target.data('url'),questionIds,replace);\n  }\n\n  pickItemPost(url, questionIds, replace=null) {\n    \n    $.post(url, {questionIds:questionIds}, html=> {\n      if (replace) {\n        this.$questionAppendForm.find('tr[data-id=\"'+replace+'\"]').replaceWith(html);\n        this.$questionAppendForm.find('tr[data-parent-id=\"'+replace+'\"]').remove();\n      } else {\n        let $tbody = this.$questionAppendForm.find('tbody:visible');\n        //fix Firefox\n        if($tbody.length <= 0  ) {\n          $tbody = this.$questionAppendForm.find('tbody');\n        }\n        $tbody.append(html).removeClass('hide');\n        $tbody.trigger('lengthChange');\n      }\n      this._refreshSeqs();\n      questionSubjectiveRemask(this.$questionAppendForm);\n      this.$questionPickerModal.modal('hide');\n      $('.js-close-modal').trigger('click');\n    });\n  }\n\n  questionPreview(event) {\n    window.open($(event.currentTarget).data('url'), '_blank','directories=0,height=580,width=820,scrollbars=1,toolbar=0,status=0,menubar=0,location=0');\n  }\n\n  batchSelectSave(event) {\n    let $target = $(event.currentTarget);\n    let questionIds = [];\n    let url = $target.data('url');\n\n\n    if (this.$questionPickerBody.find('[data-role=\"batch-item\"]:checked').length == 0 ) {\n      $('.js-choice-notice',window.parent.document).show();\n      return;\n    }\n\n    this.$questionPickerBody.find('[data-role=\"batch-item\"]:checked').each(function(index,item){\n      let questionId = $(this).data('questionId');\n      questionIds.push(questionId);\n    });\n    $target.attr('disabled',true);\n    this.pickItemPost(url, questionIds,null);\n  }\n\n  _refreshSeqs() {\n    let seq = 1;\n    this.$questionAppendForm.find('tbody tr').each(function(index,item) {\n      let $tr = $(item);\n      \n      if (!$tr.hasClass('have-sub-questions')) { \n        $tr.find('td.seq').html(seq);\n        seq ++;\n      }\n    });\n    this.$questionAppendForm.find('[name=\"questionLength\"]').val((seq - 1) > 0 ? (seq - 1) : null );\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/common/component/question-picker/index.js"],"sourceRoot":""}