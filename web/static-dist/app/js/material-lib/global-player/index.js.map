{"version":3,"sources":["webpack:///./app/Resources/static-src/app/js/material-lib/global-player/index.js","webpack:///./app/Resources/static-src/common/video-player-judge.js"],"names":["$element","$","globalPlayer","play","QiQiuYun","Player","id","playServer","app","cloudPlayServer","sdkBaseUri","cloudSdkBaseUri","disableDataUpload","cloudDisableLogReport","disableSentry","resNo","data","token","user","name","messenger","EsMessenger","project","type","on","mes","sendToParent","flashTip","swfobject","hasFlashPlayerVersion","html","Translator","trans","show","init","supportsNativeHls","video","document","createElement","canPlay","some","test","canPlayType","canItPlay","isIE","Browser","ie9","navigator","userAgent","ie10","ie11","edge","getSupportedPlayer","window","MediaSource"],"mappings":"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","file":"app/js/material-lib/global-player/index.js","sourcesContent":["import swfobject from 'es-swfobject';\nimport { getSupportedPlayer } from 'common/video-player-judge';\nimport EsMessenger from 'app/common/messenger';\nconst $element = $('#global-player');\n\nconst globalPlayer = () => {\n  const play = new QiQiuYun.Player({\n    id: 'global-player',\n    playServer: app.cloudPlayServer,\n    sdkBaseUri: app.cloudSdkBaseUri,\n    disableDataUpload: app.cloudDisableLogReport,\n    disableSentry: app.cloudDisableLogReport,\n    resNo: $element.data('resNo'),\n    token: $element.data('token'),\n    user: {\n      id: $element.data('userId'),\n      name: $element.data('userName')\n    }\n  });\n\n  const messenger = new EsMessenger({\n    name: 'parent',\n    project: 'PlayerProject',\n    type: 'child'\n  });\n  \n  play.on('video.timeupdate', (mes) => {\n    messenger.sendToParent('video.timeupdate', mes);\n  });  \n};\n\nconst flashTip = () => {\n  if (!swfobject.hasFlashPlayerVersion('11')) {\n    const html = `\n    <div class=\"alert alert-warning alert-dismissible fade in\" role=\"alert\">\n      <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\">\n      <span aria-hidden=\"true\">Ã—</span>\n      </button>\n      ${Translator.trans('site.flash_not_install_hint')}\n    </div>`;\n    $element.html(html).show();\n  } else {\n    globalPlayer();\n  }\n};\n\nconst init = () => {\n  if ($element.data('fileType') === 'video' && getSupportedPlayer() === 'flash') {\n    flashTip();\n  } else {\n    globalPlayer();\n  }\n};\n\ninit();\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/material-lib/global-player/index.js","const supportsNativeHls = () => {\n  const video = document.createElement('video');\n\n  // HLS manifests can go by many mime-types\n  const canPlay = [\n    // Apple santioned\n    'application/vnd.apple.mpegurl',\n    // Apple sanctioned for backwards compatibility\n    'audio/mpegurl',\n    // Very common\n    'audio/x-mpegurl',\n    // Very common\n    'application/x-mpegurl',\n    // Included for completeness\n    'video/x-mpegurl',\n    'video/mpegurl',\n    'application/mpegurl',\n  ];\n\n  return canPlay.some(canItPlay => (/maybe|probably/i).test(video.canPlayType(canItPlay)));\n};\n\nconst isIE = function() {\n  const Browser = {};\n  Browser.ie9 = /MSIE\\s+9.0/i.test(navigator.userAgent);\n  Browser.ie10 = /MSIE\\s+10.0/i.test(navigator.userAgent);\n  Browser.ie11 = (/Trident\\/7\\./).test(navigator.userAgent);\n  Browser.edge = /Edge\\/13./i.test(navigator.userAgent);\n  if (Browser.ie9 || Browser.ie10 || Browser.ie11 || Browser.edge) {\n    return true;\n  }\n};\n\nexport const getSupportedPlayer = () => {\n  if (supportsNativeHls()) {\n    return 'native';\n  } else if (window.MediaSource) {\n    return 'hls';\n  } else if (isIE()) {\n    return 'flash';\n  }\n  return false;\n};\n\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/common/video-player-judge.js"],"sourceRoot":""}