{"version":3,"sources":["webpack:///./app/Resources/static-src/app/js/open-course-manage/lesson/index.js","webpack:///./app/Resources/static-src/app/js/open-course-manage/lesson/lesson-manage.js"],"names":["LessonManage","$item","$","init","tooltip","asyncLoadFiles","bindEvent","on","event","publishLesson","cancelPublishLesson","deleteLesson","createLesson","$btn","target","message","Translator","trans","togglePublish","$target","post","data","html","parent","toggleClass","cd","type","confirm","title","content","okText","cancelText","response","remove","show","attr","url","get","modal","id","length","file","convertStatus","find","append"],"mappings":";;;;;;;;AAAA;;;;;;AACA,IAAIA,sBAAJ,G;;;;;;;;;;;;;;;;;;;;;;;;ICDqBA,Y;AACnB,0BAAc;AAAA;;AACZ,SAAKC,KAAL,GAAaC,EAAE,6BAAF,CAAb;AACA,SAAKC,IAAL;AACD;;;;2BAEM;AACLD,QAAE,wBAAF,EAA4BE,OAA5B;AACA,WAAKC,cAAL;AACA,WAAKC,SAAL;AACD;;;gCAEW;AAAA;;AACV,WAAKL,KAAL,CAAWM,EAAX,CAAc,OAAd,EAAuB,wBAAvB,EAAiD,UAACC,KAAD;AAAA,eAAW,MAAKC,aAAL,CAAmBD,KAAnB,CAAX;AAAA,OAAjD;AACA,WAAKP,KAAL,CAAWM,EAAX,CAAc,OAAd,EAAuB,0BAAvB,EAAmD,UAACC,KAAD;AAAA,eAAW,MAAKE,mBAAL,CAAyBF,KAAzB,CAAX;AAAA,OAAnD;AACA,WAAKP,KAAL,CAAWM,EAAX,CAAc,OAAd,EAAuB,uBAAvB,EAAgD,UAACC,KAAD;AAAA,eAAW,MAAKG,YAAL,CAAkBH,KAAlB,CAAX;AAAA,OAAhD;AACAN,QAAE,uBAAF,EAA2BK,EAA3B,CAA8B,OAA9B,EAAuC,UAACC,KAAD;AAAA,eAAW,MAAKI,YAAL,CAAkBJ,KAAlB,CAAX;AAAA,OAAvC;AACD;;;kCAEaA,K,EAAO;AACnB,UAAMK,OAAOX,EAAEM,MAAMM,MAAR,CAAb;AACA,UAAMC,UAAUC,WAAWC,KAAX,CAAiB,iCAAjB,CAAhB;AACA,WAAKC,aAAL,CAAmBL,IAAnB,EAAyBE,OAAzB;AACD;;;wCAEmBP,K,EAAO;AACzB,UAAMK,OAAOX,EAAEM,MAAMM,MAAR,CAAb;AACA,UAAMC,UAAUC,WAAWC,KAAX,CAAiB,oCAAjB,CAAhB;AACA,WAAKC,aAAL,CAAmBL,IAAnB,EAAyBE,OAAzB;AACD;;;kCAEaI,O,EAASJ,O,EAAS;AAC9Bb,QAAEkB,IAAF,CAAOD,QAAQE,IAAR,CAAa,KAAb,CAAP,EAA4B,UAACC,IAAD,EAAU;AACpCpB,UAAE,yEAAF,EAA6EqB,MAA7E,GAAsFC,WAAtF,CAAkG,QAAlG;AACAtB,UAAE,sBAAF,EAA0BsB,WAA1B,CAAsC,QAAtC;AACAC,WAAGV,OAAH,CAAW,EAAEW,MAAM,SAAR,EAAmBX,SAASA,OAA5B,EAAX;AACD,OAJD;AAKD;;;iCAEYP,K,EAAO;AAAA;;AAClB,UAAMK,OAAOX,EAAEM,MAAMM,MAAR,CAAb;AACAW,SAAGE,OAAH,CAAW;AACTC,eAAOZ,WAAWC,KAAX,CAAiB,aAAjB,CADE;AAETY,iBAASb,WAAWC,KAAX,CAAiB,gCAAjB,CAFA;AAGTa,gBAAQd,WAAWC,KAAX,CAAiB,cAAjB,CAHC;AAITc,oBAAYf,WAAWC,KAAX,CAAiB,YAAjB;AAJH,OAAX,EAKGV,EALH,CAKM,IALN,EAKY,YAAM;AAChBL,UAAEkB,IAAF,CAAOP,KAAKQ,IAAL,CAAU,KAAV,CAAP,EAAyB,UAACW,QAAD,EAAc;AACrC,iBAAK/B,KAAL,CAAWgC,MAAX;AACA/B,YAAE,mBAAF,EAAuBgC,IAAvB;AACAhC,YAAE,uBAAF,EAA2BiC,IAA3B,CAAgC,UAAhC,EAA4C,KAA5C;AACAV,aAAGV,OAAH,CAAW,EAAEW,MAAM,SAAR,EAAmBX,SAASC,WAAWC,KAAX,CAAiB,wCAAjB,CAA5B,EAAX;AACD,SALD,EAKG,MALH;AAMD,OAZD;AAaD;;;iCAEYT,K,EAAO;AAClB,UAAI4B,MAAMlC,EAAEM,MAAMM,MAAR,EAAgBO,IAAhB,CAAqB,KAArB,CAAV;AACAnB,QAAEmC,GAAF,CAAMD,GAAN,EAAW,UAACf,IAAD,EAAU;AACnB,YAAIA,KAAK,QAAL,CAAJ,EAAoB;AAClBI,aAAGV,OAAH,CAAW,EAAEW,MAAM,SAAR,EAAmBX,SAASC,WAAWC,KAAX,CAAiB,6BAAjB,CAA5B,EAAX;AACD,SAFD,MAEO;AACLf,YAAE,QAAF,EAAYoB,IAAZ,CAAiBD,IAAjB;AACAnB,YAAE,QAAF,EAAYoC,KAAZ,CAAkB,MAAlB;AACD;AACF,OAPD;AAQD;;;qCAEgB;AAAA;;AACf,UAAMF,MAAMlC,EAAE,yBAAF,EAA6BmB,IAA7B,CAAkC,iBAAlC,CAAZ;AACA,UAAMkB,KAAK,KAAKtC,KAAL,CAAWoB,IAAX,CAAgB,QAAhB,CAAX;AACAnB,QAAEkB,IAAF,CAAOgB,GAAP,EAAY,EAAE,OAAOG,EAAT,EAAZ,EAA2B,UAAClB,IAAD,EAAU;AACnC,YAAI,CAACA,IAAD,IAASA,KAAKmB,MAAL,IAAe,CAA5B,EAA+B;AAC7B;AACD;AACD,YAAMC,OAAOpB,KAAK,CAAL,CAAb;AACA,YAAIoB,KAAKC,aAAL,IAAsB,SAAtB,IAAmCD,KAAKC,aAAL,IAAsB,OAA7D,EAAsE;AACpE,iBAAKzC,KAAL,CAAW0C,IAAX,CAAgB,+BAAhB,EAAiDC,MAAjD,CAAwD,kCAAgC5B,WAAWC,KAAX,CAAiB,yCAAjB,CAAhC,GAA4F,SAApJ;AACD,SAFD,MAEO,IAAIwB,KAAKC,aAAL,IAAsB,OAA1B,EAAmC;AACxC,iBAAKzC,KAAL,CAAW0C,IAAX,CAAgB,+BAAhB,EAAiDC,MAAjD,CAAwD,iCAA+B5B,WAAWC,KAAX,CAAiB,gDAAjB,CAA/B,GAAkG,SAA1J;AACD;AACF,OAVD;AAWD;;;;;kBAlFkBjB,Y","file":"app/js/open-course-manage/lesson/index.js","sourcesContent":["import LessonManage from './lesson-manage';\nnew LessonManage();\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/open-course-manage/lesson/index.js","export default class LessonManage {\n  constructor() {\n    this.$item = $('.js-open-course-lesson-item');\n    this.init();\n  }\n\n  init() {\n    $('.js-file-delete-lesson').tooltip();\n    this.asyncLoadFiles();\n    this.bindEvent();\n  }\n\n  bindEvent() {\n    this.$item.on('click', '.js-publish-lesson-btn', (event) => this.publishLesson(event));\n    this.$item.on('click', '.js-unpublish-lesson-btn', (event) => this.cancelPublishLesson(event));\n    this.$item.on('click', '.js-delete-lesson-btn', (event) => this.deleteLesson(event));\n    $('.js-lesson-create-btn').on('click', (event) => this.createLesson(event));\n  }\n\n  publishLesson(event) {\n    const $btn = $(event.target);\n    const message = Translator.trans('open_course.publish_lesson_hint');\n    this.togglePublish($btn, message);\n  }\n\n  cancelPublishLesson(event) {\n    const $btn = $(event.target);\n    const message = Translator.trans('open_course.unpublish_success_hint');\n    this.togglePublish($btn, message);\n  }\n\n  togglePublish($target, message) {\n    $.post($target.data('url'), (html) => {\n      $('.js-publish-lesson-btn, .js-delete-lesson-btn, .js-unpublish-lesson-btn').parent().toggleClass('hidden');\n      $('.js-unpublish-status').toggleClass('hidden');\n      cd.message({ type: 'success', message: message });\n    });\n  }\n\n  deleteLesson(event) {\n    const $btn = $(event.target);\n    cd.confirm({\n      title: Translator.trans('site.delete'),\n      content: Translator.trans('open_course.lesson_delete_hint'),\n      okText: Translator.trans('site.confirm'),\n      cancelText: Translator.trans('site.close')\n    }).on('ok', () => {\n      $.post($btn.data('url'), (response) => {\n        this.$item.remove();\n        $('.js-lesson-notify').show();\n        $('.js-lesson-create-btn').attr('disabled', false);\n        cd.message({ type: 'success', message: Translator.trans('open_course.lesson_delete_success_hint') });\n      }, 'json');\n    });\n  }\n\n  createLesson(event) {\n    let url = $(event.target).data('url');\n    $.get(url, (data) => {\n      if (data['result']) {\n        cd.message({ type: 'warning', message: Translator.trans('open_course.add_lesson_hint') });\n      } else {\n        $('#modal').html(data);\n        $('#modal').modal('show');\n      }\n    });\n  }\n\n  asyncLoadFiles() {\n    const url = $('.js-lesson-manage-panel').data('file-status-url');\n    const id = this.$item.data('fileId');\n    $.post(url, { 'ids': id }, (data) => {\n      if (!data || data.length == 0) {\n        return;\n      }\n      const file = data[0];\n      if (file.convertStatus == 'waiting' || file.convertStatus == 'doing') {\n        this.$item.find('span[data-role=\"mediaStatus\"]').append('<span class=\\'text-warning\\'>'+Translator.trans('open_course.file_format_conversion_hint')+'</span>');\n      } else if (file.convertStatus == 'error') {\n        this.$item.find('span[data-role=\"mediaStatus\"]').append('<span class=\\'text-danger\\'>'+Translator.trans('open_course.file_format_conversion_failed_hint')+'</span>');\n      }\n    });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/open-course-manage/lesson/lesson-manage.js"],"sourceRoot":""}