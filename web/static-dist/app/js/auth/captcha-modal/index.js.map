{"version":3,"sources":["webpack:///external \"jQuery\"","webpack:///./app/Resources/static-src/app/js/auth/captcha-modal/index.js","webpack:///./app/Resources/static-src/app/js/auth/captcha-mobile-modal.js"],"names":["dataTo","smsType","captchaNum","$","length","val","find","attr","data","Math","random","captchaModal","CaptchaModal","console","log","$element","CaptchaValidator","init","on","event","changeCaptcha","click","submitForm","initValidator","e","$code","currentTarget","form","submit","_captchaValidated","validate","onkeyup","onfocusout","rules","captcha_num","required","alphanumeric","messages","Translator","trans","submitHandler","get","value","response","success","parents","modal","smsSender","SmsSender","element","url","captcha","captchaValidated","preSmsSend","couldSender","off","html","show","keydown","keyCode"],"mappings":"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","file":"app/js/auth/captcha-modal/index.js","sourcesContent":["module.exports = jQuery;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jQuery\"\n// module id = 0\n// module chunks = app/js/main app/js/v2/demo/index app/js/activity-manage/doc/index app/js/activity-manage/download/index app/js/activity-manage/flash/index app/js/activity-manage/homework/index app/js/activity-manage/ppt/index app/js/activity-manage/video/index app/js/article/detail/index app/js/attachment/index app/js/auth/captcha-modal/index app/js/auth/password-reset/index app/js/auth/register/index app/js/batch-upload/index app/js/card/card-receive/index app/js/card/index/index app/js/cashier/index app/js/cashier/modal/index app/js/classroom-manage/set-picture/index app/js/classroom-manage/student-expiryday/index app/js/classroom-manage/student-import/index app/js/classroom-manage/students-create/index app/js/classroom-manage/students-manage/index app/js/classroom/buy-modal/index app/js/classroom/index app/js/classroom/thread-form/index app/js/classroom/thread-show/index app/js/coin/invite-code/index app/js/course-chapter-manage/index app/js/course-manage-file/index/index app/js/course-manage/batch-create/index app/js/course-manage/lesson-manage/default/index app/js/course-manage/lesson-manage/normal/index app/js/course-manage/live-replay/upload/index app/js/course-manage/overview/index app/js/course-manage/student-import/index app/js/course/buy-modal/index app/js/course/thread-show/index app/js/courseset/show/index app/js/exporter/index app/js/group/index app/js/group/logo/index app/js/group/thread-add/index app/js/live-course/explore/index app/js/material-lib/index/index app/js/material-lib/share-history/index app/js/media-manage/index app/js/activity-manage/audio/index app/js/mobile-bind/index app/js/my/order-refund-apply/index app/js/my/order-refund/index app/js/my/order/index app/js/oauth2/create/index app/js/open-course-manage/add-material/index app/js/open-course-manage/lesson-modal/index app/js/open-course/index app/js/open-course/member-sms/index app/js/order/coupon-item/index app/js/order/create-sms/index app/js/order/create/index app/js/pay/select/index app/js/pay/show-mobile-modal/index app/js/player/index app/js/question-manage/form/index app/js/review/list/index app/js/search/index app/js/settings/avatar-crop-modal/index app/js/settings/bind-mobile/index app/js/settings/email/index app/js/settings/find_pay_password_by_sms/index app/js/settings/find-pay-password/index app/js/settings/password/index app/js/settings/pay-password-modal/index app/js/settings/pay-password/index app/js/settings/profile/index app/js/settings/reset-pay-password/index app/js/settings/security-questions/index app/js/settings/security/index app/js/settings/setup-password/index app/js/settings/setup/index app/js/settings/update-pay-password/index app/js/settings/user-profile/index app/js/subject/index app/js/task-manage/create/index app/js/task/plugin/note/index app/js/task/plugin/question/index app/js/testpaper-manage/create/index app/js/testpaper-manage/index app/js/testpaper-manage/questions/index app/js/testpaper/do-test/exercise/index app/js/testpaper/do-test/normal/index app/js/testpaper/result/index app/js/thread/user-info-modal/index app/js/user/fill-info/index app/js/message/show/index","import CaptchaModal from 'app/js/auth/captcha-mobile-modal';\n\nlet dataTo = '';\nlet smsType = '';\nlet captchaNum = 'captcha_num';\nif ($('input[name=\"set_bind_emailOrMobile\"]').length > 0) {\n  dataTo = 'set_bind_emailOrMobile';\n  smsType = 'sms_registration';\n} else if ($('input[name=\"mobile\"]').length > 0) {\n  dataTo = 'mobile';\n  if ($('#password-reset-by-mobile-form').length > 0) {\n    smsType = 'sms_forget_password';\n  } else if ($('#settings-find-pay-password-form').length > 0) {\n    smsType = 'sms_forget_pay_password';\n  } else {\n    smsType = 'sms_bind';\n  }\n} else {\n  dataTo = $('[name=\"verifiedMobile\"]').val() == null ? 'emailOrMobile' : 'verifiedMobile';\n  smsType = 'sms_registration';\n}\n\n$('#captcha-form').find('#getcode_num').attr('src', $('#getcode_num').data('url') + '?' + Math.random());\n\nlet captchaModal = new CaptchaModal($('#captcha-form'),dataTo,smsType,captchaNum);\n\nconsole.log($('#captcha-form'));\nconsole.log(captchaModal);\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/auth/captcha-modal/index.js","import SmsSender from 'app/common/widget/sms-sender';\n\nexport default class CaptchaModal {\n  constructor($element, dataTo, smsType, captchaNum) {\n    this.$element = $element;\n    this.dataTo = dataTo;\n    this.smsType = smsType;\n    this.captchaNum = captchaNum;\n    this.CaptchaValidator = null;\n    this.init();\n  }\n  init() {\n    this.$element.on('click', '#getcode_num', (event) => this.changeCaptcha(event));\n    $('.js-captcha-btn').click((event) => this.submitForm(event));\n    this.initValidator();\n  }\n  changeCaptcha(e) {\n    var $code = $(e.currentTarget);\n    $code.attr('src', $code.data('url') + '?' + Math.random());\n  }\n\n  submitForm() {\n    if(this.CaptchaValidator.form()) {\n      this.$element.submit();\n    }\n  }\n\n  initValidator() {\n    this._captchaValidated = false;\n    this.CaptchaValidator = this.$element.validate({\n      onkeyup: false,\n      onfocusout: false,\n      rules: {\n        captcha_num: {\n          required: true,\n          alphanumeric: true,\n        }\n      },\n      messages: {\n        captcha_num: {\n          required: Translator.trans('auth.mobile_captcha_required_error_hint'),\n        }\n      },\n      submitHandler:  (form) =>{\n        console.log('submitHandler');\n        $.get(this.$element.attr('action'), { value: $('#captcha_num_modal').val() }, (response) => {\n          if (response.success) {\n            this.$element.parents('.modal').modal('hide');\n            this._captchaValidated = true;\n            var smsSender = new SmsSender({\n              element: '.js-sms-send',\n              url: $('.js-sms-send').data('smsUrl'),\n              smsType: this.smsType,\n              dataTo: this.dataTo,\n              captchaNum: this.captchaNum,\n              captcha: true,\n              captchaValidated: this._captchaValidated,\n              preSmsSend: function () {\n                var couldSender = true;\n                return couldSender;\n              }\n            });\n            $('.js-sms-send').off('click');\n          } else {\n            this._captchaValidated = false;\n            this.$element.find('#getcode_num').attr('src', $('#getcode_num').data('url') + '?' + Math.random());\n            this.$element.find('.help-block').html('<span class=\"color-danger\">' + Translator.trans('auth.mobile_captcha_error_hint') + '</span>');\n            this.$element.find('.help-block').show();\n          }\n        }, 'json');\n      }\n    });\n    $('#captcha_num_modal').keydown((event) => {\n      if (event.keyCode == 13) {\n        this.CaptchaValidator.form();\n      }\n    });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/auth/captcha-mobile-modal.js"],"sourceRoot":""}