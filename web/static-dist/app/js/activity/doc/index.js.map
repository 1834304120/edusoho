{"version":3,"sources":["webpack:///./app/Resources/static-src/app/js/activity/doc/index.js","webpack:///./app/Resources/static-src/app/common/doc-player.js"],"names":["$element","$","watermarkUrl","data","get","watermark","console","log","initDocPlayer","contents","DocPlayer","element","swfUrl","pdfUrl","watermarkOptions","xPosition","yPosition","rotate","canCopy","swfPlayerWidth","swfPlayerHeight","swfPlayerUrl","init","isSupportHtml5","isIE9","initPDFJSViewer","initSwfViewer","onFullScreen","docPlayer","window","onmessage","e","undefined","isPageFullScreen","docContent","parent","document","removeClass","width","addClass","body","offsetWidth","navigator","appVersion","indexOf","support","leadingWhitespace","attr","src","app","cloudOldDocumentSdkUrl","$iframe","append","addWatermark","html","Translator","trans","flashVars","doc_url","decodeURI","value","params","bgcolor","allowFullScreen","wmode","allowNetworking","allowscriptaccess","autoPlay","attributes","id","swfobject","embedSWF","WaterMark"],"mappings":"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","file":"app/js/activity/doc/index.js","sourcesContent":["import DocPlayer from 'app/common/doc-player';\n\nlet $element = $('#document-content');\nlet watermarkUrl = $element.data('watermark-url');\n\nif(watermarkUrl) {\n  $.get(watermarkUrl, function(watermark) {\n    console.log(watermark);\n    initDocPlayer(watermark);\n  });\n}else {\n  initDocPlayer('');\n}\n\nfunction initDocPlayer(contents) {\n  new DocPlayer({\n    element: $element,\n    swfUrl: $element.data('swf'),\n    pdfUrl: $element.data('pdf'),\n    watermarkOptions: {\n      contents,\n      xPosition: 'center',\n      yPosition: 'center',\n      rotate: 45,\n    },\n    canCopy: $element.data('disableCopy')\n  });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/activity/doc/index.js","import swfobject from 'es-swfobject';\nimport 'app/common/watermark';\n\nclass DocPlayer {\n  constructor({ element, swfUrl, pdfUrl, watermarkOptions, canCopy }) {\n    this.element = $(element);\n    this.swfUrl = swfUrl || '';\n    this.pdfUrl = pdfUrl || '';\n    this.swfPlayerWidth = '100%';\n    this.swfPlayerHeight = '100%';\n    this.swfPlayerUrl = '';\n    this.watermarkOptions = watermarkOptions || '';\n    this.canCopy = canCopy || false;\n    this.init();\n\n    console.log(watermarkOptions);\n  }\n\n  init() {\n    if (this.isSupportHtml5() && !this.isIE9()) {\n      this.initPDFJSViewer();\n    } else {\n      this.initSwfViewer();\n    }\n    this.onFullScreen();\n  }\n\n  onFullScreen(docPlayer) {\n    window.onmessage=function(e){\n      console.log(e.data);\n      if(e == null || e == undefined ){\n        return;\n      }\n      var isPageFullScreen = e.data;\n      if(typeof(isPageFullScreen) != 'boolean'){\n        return ;\n      }\n      var docContent =  $('#task-content-iframe', window.parent.document);\n      if (isPageFullScreen) {\n        docContent.removeClass('screen-full');\n        docContent.width('100%');\n      }else{\n        docContent.addClass('screen-full');\n        docContent.width( window.document.body.offsetWidth+'px');\n      }\n    };\n  }\n\n  isIE9() {\n    return navigator.appVersion.indexOf('MSIE 9.') != -1;\n  }\n\n  isSupportHtml5() {\n    return $.support.leadingWhitespace;\n  }\n\n  initPDFJSViewer() {\n    $('html').attr('dir', 'ltr');\n\n    let src = app.cloudOldDocumentSdkUrl + '#' + this.pdfUrl;\n\n    if (!this.canCopy) {\n      src += '#false';\n    }\n\n    let $iframe = `<iframe id=\"doc-pdf-player\" class=\"task-content-iframe\" \n     src=\"${src}\" style=\"width:100%;height:100%;border:0px\" \n     allowfullscreen=\"\" webkitallowfullscreen=\"\">\n      </iframe>`;\n    this.element.append($iframe);\n\n    this.addWatermark();\n  }\n\n  initSwfViewer() {\n    $.html(`<div id=\"website\"><p align=\"center\" class=\"style1\">${Translator.trans('site.flash_not_install_hint')}</p></div>`);\n\n    let flashVars = {\n      doc_url: decodeURI(this.swfUrl.value)\n    };\n\n    let params = {\n      bgcolor: '#efefef',\n      allowFullScreen: true,\n      wmode: 'window',\n      allowNetworking: 'all',\n      allowscriptaccess: 'always',\n      autoPlay: false\n    };\n\n    let attributes = {\n      id: 'website'\n    };\n\n    swfobject.embedSWF(\n      this.swfPlayerUrl,\n      'website',\n      this.swfPlayerWidth,\n      this.swfPlayerHeight,\n      '9.0.45',\n      null,\n      flashVars,\n      params,\n      attributes\n    );\n\n    this.addWatermark();\n  }\n\n  addWatermark() {\n    this.watermarkOptions && this.element.WaterMark(this.watermarkOptions);\n  }\n}\n\n\nexport default DocPlayer;\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/common/doc-player.js"],"sourceRoot":""}