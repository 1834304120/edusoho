{"version":3,"sources":["webpack:///external \"jQuery\"","webpack:///./app/Resources/static-src/app/js/open-course-manage/lesson-modal/index.js","webpack:///./app/Resources/static-src/app/js/activity-manage/video/subtitle/dialog.js","webpack:///./app/Resources/static-src/common/load-animation.js","webpack:///./app/Resources/static-src/app/js/open-course-manage/lesson-modal/lesson-modal.js"],"names":["LessonModal","element","form","SubtitleDialog","$","upload_id","inited","length","init","$container","closest","find","val","render","id","self","on","$elem","post","data","Translator","trans","parent","remove","show","media","html","get","mediaId","initUploader","globalId","uploader","_destroyUploader","UploaderSDK","sdkBaseUri","app","cloudSdkBaseUri","disableDataUpload","cloudDisableLogReport","disableSentry","initUrl","finishUrl","ui","multi","accept","extensions","mimeTypes","type","process","common","videoNo","locale","document","documentElement","lang","err","error","file","name","success","convertStatus","waiting","doing","none","append","hide","responseJSON","message","removeClass","addClass","__events","destroy","e","loadAnimation","fn","$element","$loading","prependTo","nextAll","arr","l","x","push","callee","apply","options","$form","validator","initfileChooser","validate","currentDom","ajax","groups","date","rules","title","required","maxlength","trim","course_title","minute","second","messages","second_range","submitSuccess","res","cd","location","reload","submitError","msg","errorRes","JSON","parse","responseText","click","event","submit","blur","parseInt","fileChooser","FileChooser","subtitleDialog","onSelectFile","closeUI","Math","round","source","uri","openUI"],"mappings":"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","file":"app/js/open-course-manage/lesson-modal/index.js","sourcesContent":["module.exports = jQuery;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jQuery\"\n// module id = 0\n// module chunks = app/js/main app/js/v2/demo/index app/js/activity-manage/doc/index app/js/activity-manage/download/index app/js/activity-manage/flash/index app/js/activity-manage/homework/index app/js/activity-manage/ppt/index app/js/activity-manage/video/index app/js/article/detail/index app/js/attachment/index app/js/auth/captcha-modal/index app/js/auth/password-reset/index app/js/auth/register/index app/js/batch-upload/index app/js/card/card-receive/index app/js/card/index/index app/js/cashier/index app/js/cashier/modal/index app/js/classroom-manage/set-picture/index app/js/classroom-manage/student-expiryday/index app/js/classroom-manage/student-import/index app/js/classroom-manage/students-create/index app/js/classroom-manage/students-manage/index app/js/classroom/buy-modal/index app/js/classroom/index app/js/classroom/thread-form/index app/js/classroom/thread-show/index app/js/coin/invite-code/index app/js/course-chapter-manage/index app/js/course-manage-file/index/index app/js/course-manage/batch-create/index app/js/course-manage/lesson-manage/default/index app/js/course-manage/lesson-manage/normal/index app/js/course-manage/live-replay/upload/index app/js/course-manage/overview/index app/js/course-manage/student-import/index app/js/course/buy-modal/index app/js/course/thread-show/index app/js/courseset/show/index app/js/exporter/index app/js/group/index app/js/group/logo/index app/js/group/thread-add/index app/js/live-course/explore/index app/js/material-lib/index/index app/js/material-lib/share-history/index app/js/media-manage/index app/js/activity-manage/audio/index app/js/mobile-bind/index app/js/my/order-refund-apply/index app/js/my/order-refund/index app/js/my/order/index app/js/oauth2/create/index app/js/open-course-manage/add-material/index app/js/open-course-manage/lesson-modal/index app/js/open-course/index app/js/open-course/member-sms/index app/js/order/coupon-item/index app/js/order/create-sms/index app/js/order/create/index app/js/pay/select/index app/js/pay/show-mobile-modal/index app/js/player/index app/js/question-manage/form/index app/js/review/list/index app/js/search/index app/js/settings/avatar-crop-modal/index app/js/settings/bind-mobile/index app/js/settings/email/index app/js/settings/find_pay_password_by_sms/index app/js/settings/find-pay-password/index app/js/settings/password/index app/js/settings/pay-password-modal/index app/js/settings/pay-password/index app/js/settings/profile/index app/js/settings/reset-pay-password/index app/js/settings/security-questions/index app/js/settings/security/index app/js/settings/setup-password/index app/js/settings/setup/index app/js/settings/update-pay-password/index app/js/settings/user-profile/index app/js/subject/index app/js/task-manage/create/index app/js/task/plugin/note/index app/js/task/plugin/question/index app/js/testpaper-manage/create/index app/js/testpaper-manage/index app/js/testpaper-manage/questions/index app/js/testpaper/do-test/exercise/index app/js/testpaper/do-test/normal/index app/js/testpaper/result/index app/js/thread/user-info-modal/index app/js/user/fill-info/index app/js/message/show/index","import LessonModal from './lesson-modal';\n\nnew LessonModal({\n  element: '#modal',\n  form: '#lesson-create-form'\n});\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/open-course-manage/lesson-modal/index.js","import notify from 'common/notify';\n\nclass SubtitleDialog {\n  constructor(element) {\n    this.element = $(element);\n    this.upload_id = 'subtitle-uploader';\n    this.inited = false;\n    if (this.element.length > 0) {\n      this.init();\n      this.inited = true;\n    }\n\n    let $container = this.element.closest('#video-subtitle-form-group');\n    if ($container.find('#ext_mediaId_for_subtitle').val() > 0) {\n      this.render({id: $container.find('#ext_mediaId_for_subtitle').val()});\n    }\n  }\n\n  init() {\n\n    let self = this;\n    //删除字幕\n    this.element.on('click', '.js-subtitle-delete', function () {\n      let $elem = $(this);\n      $.post($elem.data('subtitleDeleteUrl'), function (data) {\n        if (data) {\n          notify('success', Translator.trans('activity.video_manage.delete_success_hint'));\n          $elem.parent().remove();\n          $('#' + self.upload_id).show();\n        }\n      });\n    });\n  }\n\n\n  render(media) {\n    if (!this.inited) {\n      return;\n    }\n\n    if (media && 'id' in media && media.id > 0) {\n      this.media = media;\n      this.element.html(Translator.trans('activity.video_manage.subtitle_load_hint'));\n      let self = this;\n      $.get(this.element.data('dialogUrl'), {mediaId: this.media.id}, function (html) {\n        self.element.html(html);\n        self.initUploader();\n      });\n    }\n  }\n\n  initUploader() {\n    let self = this;\n    let $elem = $('#' + this.upload_id);\n    let mediaId = $('.js-subtitle-dialog').data('mediaId');\n    let globalId = $elem.data('mediaGlobalId');\n\n    if (this.uploader) {\n      this._destroyUploader();\n    }\n    let uploader = new UploaderSDK({\n      sdkBaseUri: app.cloudSdkBaseUri,\n      disableDataUpload: app.cloudDisableLogReport,\n      disableSentry: app.cloudDisableLogReport,\n      initUrl: $elem.data('initUrl'),\n      finishUrl: $elem.data('finishUrl'),\n      id: this.upload_id,\n      ui: 'simple',\n      multi: true,\n      accept: {\n        extensions: ['srt'],\n        mimeTypes: ['text/srt']\n      },\n      type: 'sub',\n      process: {\n        common: {\n          videoNo: globalId,\n        }\n      },\n      locale: document.documentElement.lang\n    });\n\n    uploader.on('error', function (err) {\n      if (err.error === 'Q_TYPE_DENIED') {\n        notify('danger', Translator.trans('activity.video_manage.subtitle_upload_error_hint'));\n      }\n    });\n\n    uploader.on('file.finish', function (file) {\n      $.post($elem.data('subtitleCreateUrl'), {\n        'name': file.name,\n        'subtitleId': file.id,\n        'mediaId': mediaId\n      }).success(function (data) {\n        let convertStatus = {\n          waiting: Translator.trans('activity.video_manage.convert_status_waiting'),\n          doing: Translator.trans('activity.video_manage.convert_status_doing'),\n          success: Translator.trans('activity.video_manage.convert_status_success'),\n          error: Translator.trans('activity.video_manage.convert_status_error'),\n          none: Translator.trans('activity.video_manage.convert_status_none')\n        };\n        $('.js-media-subtitle-list').append('<li class=\"pvs mtm\">' +\n          '<span class=\"subtitle-name prl pull-left\">' + data.name + '</span>' +\n          '<span class=\"subtitle-transcode-status ' + data.convertStatus + '\">' + convertStatus[data.convertStatus] + '</span>' +\n          '<a href=\"javascript:;\" class=\"btn-link pll color-primary js-subtitle-delete\" data-subtitle-delete-url=\"/media/' + mediaId + '/subtitle/' + data.id + '/delete\">'+Translator.trans('activity.video_manage.subtitle_delete_hint')+'</a>' +\n          '</li>');\n        if ($('.js-media-subtitle-list li').length > 3) {\n          $('#' + self.upload_id).hide();\n        }\n        notify('success', Translator.trans('activity.video_manage.subtitle_upload_success_hint'));\n      }).error(function (data) {\n        notify('danger', data.responseJSON.error.message);\n      });\n    });\n\n    this.uploader = uploader;\n  }\n\n  show() {\n    let parent = this.element.parent('.form-group');\n    if (parent.length > 0) {\n      parent.removeClass('hide');\n    }\n  }\n\n  hide() {\n    let parent = this.element.parent('.form-group');\n    if (parent.length > 0) {\n      parent.addClass('hide');\n    }\n  }\n\n  _destroyUploader() {\n    if (!this.uploader) {\n      return;\n    }\n    this.uploader.__events = null;\n    try {\n      this.uploader.destroy();\n    } catch (e) {\n      //忽略destroy异常\n    }\n    this.uploader = null;\n  }\n\n  destroy() {\n    if (!this.inited) {\n      return;\n    }\n    this._destroyUploader();\n  }\n}\n\nexport default SubtitleDialog;\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/activity-manage/video/subtitle/dialog.js","const loadAnimation = (fn, $element) => {\n  let $loading = $element.find('.load-animation');\n  if ($loading.length == 0) {\n    $loading = $('<div class=\"load-animation\"></div>');\n    $loading.prependTo($element).nextAll().hide();\n  } else {\n    $loading.show();\n  }\n  let arr = [], l = fn.length;\n  return (x) => {\n    arr.push(x);\n    $loading.hide().nextAll().show();\n    /* eslint-disable */\n    return arr.length < l ? arguments.callee : fn.apply(null, arr);\n    /* eslint-enable */\n  };\n};\n\nexport default loadAnimation;\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/common/load-animation.js","import loadAnimation from 'common/load-animation';\nimport FileChooser from 'app/js/file-chooser/file-choose';\nimport SubtitleDialog from 'app/js/activity-manage/video/subtitle/dialog';\n\nclass LessonModal {\n  constructor(options) {\n    this.$element = $(options.element);\n    this.$form = $(options.form);\n    this.validator();\n    this.initfileChooser();\n  }\n\n  validator() {\n    let validator = this.$form.validate({\n      currentDom: '#form-submit',\n      ajax: true,\n      groups: {\n        date: 'minute second'\n      },\n      rules: {\n        title: {\n          required: true,\n          maxlength: 50,\n          trim: true,\n          course_title: true,\n        },\n        minute: 'required unsigned_integer',\n        second: 'required second_range',\n        'mediaSource': 'required',\n      },\n      messages: {\n        minute: {\n          required: Translator.trans('activity.video_manage.length_required_error_hint'),\n        },\n        second: {\n          required: Translator.trans('activity.video_manage.length_required_error_hint'),\n          second_range: Translator.trans('validate.second_range.message'),\n        },\n        'mediaSource': Translator.trans('activity.video_manage.media_error_hint'),\n      },\n      submitSuccess(res) {\n        cd.message({ type: 'success', message: Translator.trans('open_course.lesson.create_success')});\n        document.location.reload();\n      },\n      submitError(res) {\n        let msg = '';\n        let errorRes = JSON.parse(res.responseText);\n        if (errorRes.error && errorRes.error.message) {\n          msg = errorRes.error.message;\n        }\n        cd.message({ type: 'warning', message: Translator.trans('open_course.lesson.create_error') + ':' + msg });\n      }\n    });\n\n    $('#form-submit').click((event) => {\n      if(validator.form()) {\n        this.$form.submit();\n      }\n    });\n\n    $('.js-length').blur(function () {\n      if (validator && validator.form()) {\n        const minute = parseInt($('#minute').val()) | 0;\n        const second = parseInt($('#second').val()) | 0;\n        $('#length').val(minute * 60 + second);\n      }\n    });\n  }\n\n  initfileChooser() {\n    const fileChooser = new FileChooser();\n    //字幕组件\n    const subtitleDialog = new SubtitleDialog('.js-subtitle-list');\n    const onSelectFile = file => {\n      FileChooser.closeUI();\n      if (file.length && file.length > 0) {\n        let minute = parseInt(file.length / 60);\n        let second = Math.round(file.length % 60);\n        $('#minute').val(minute);\n        $('#second').val(second);\n        $('#length').val(minute * 60 + second);\n      }\n      $('#mediaSource').val(file.source);\n      if (file.source == 'self') {\n        $('#mediaId').val(file.id);\n        $('#mediaUri').val('');\n        $('#mediaName').val(file.name);\n      } else {\n        $('#mediaUri').val(file.uri);\n        $('#mediaId').val(0);\n        $('#mediaName').val(file.name);\n      }\n      //渲染字幕\n      subtitleDialog.render(file);\n    };\n\n    this.$element.on('click', '.js-choose-trigger', (event) => {\n      FileChooser.openUI();\n      $('[name=\"mediaSource').val(null);\n    });\n\n    fileChooser.on('select', onSelectFile);\n  }\n}\n\nexport default LessonModal;\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/open-course-manage/lesson-modal/lesson-modal.js"],"sourceRoot":""}