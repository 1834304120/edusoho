{"version":3,"sources":["webpack:///external \"jQuery\"","webpack:///./app/Resources/static-src/app/js/course/thread-show/index.js"],"names":["$","length","editor","CKEDITOR","replace","toolbar","fileSingleSizeLimit","app","filebrowserImageUploadUrl","data","on","val","getData","$form","validator","validate","rules","required","click","form","button","find","remove","ajax","attr","serialize","success","html","console","log","text","parseInt","id","appendTo","setData","empty","show","removeAttr","window","location","href","error","$btn","confirm","post","url","reload","userName","parent","focus","insertHtml","Translator","trans"],"mappings":";;;;;AAAA,wB;;;;;;;;;;ACAA;;;;;;AAEA,IAAIA,EAAE,eAAF,EAAmBC,MAAnB,IAA6B,CAAjC,EAAoC;AAClC,MAAIC,SAASC,SAASC,OAAT,CAAiB,cAAjB,EAAiC;AAC5CC,aAAS,QADmC;AAE5CC,yBAAqBC,IAAID,mBAFmB;AAG5CE,+BAA2BR,EAAE,eAAF,EAAmBS,IAAnB,CAAwB,gBAAxB;AAHiB,GAAjC,CAAb;AAKAP,SAAOQ,EAAP,CAAU,QAAV,EAAoB,YAAM;AACxBV,MAAE,eAAF,EAAmBW,GAAnB,CAAuBT,OAAOU,OAAP,EAAvB;AACD,GAFD;AAGAV,SAAOQ,EAAP,CAAU,MAAV,EAAkB,YAAM;AACtBV,MAAE,eAAF,EAAmBW,GAAnB,CAAuBT,OAAOU,OAAP,EAAvB;AACD,GAFD;AAGD;;AAED,IAAIC,QAAQb,EAAE,mBAAF,CAAZ;;AAEA,IAAIc,YAAYD,MAAME,QAAN,CAAe;AAC7BC,SAAO;AACL,qBAAiB;AACfC,gBAAU;AADK;AADZ;AADsB,CAAf,CAAhB;;AASAjB,EAAE,+BAAF,EAAmCkB,KAAnC,CAAyC,YAAM;AAC7C,MAAIJ,UAAUK,IAAV,EAAJ,EAAsB;AACpBnB,MAAE,+BAAF,EAAmCoB,MAAnC,CAA0C,SAA1C;AACApB,MAAE,mBAAF,EAAuBqB,IAAvB,CAA4B,UAA5B,EAAwCC,MAAxC;AACA,QAAIT,QAAQb,EAAE,mBAAF,CAAZ;AACAA,MAAEuB,IAAF,CAAO;AACL,aAAOV,MAAMW,IAAN,CAAW,QAAX,CADF;AAEL,cAAQ,MAFH;AAGL,cAAQX,MAAMY,SAAN,EAHH;AAILC,eAAS,iBAAUC,IAAV,EAAgB;AACvB3B,UAAE,+BAAF,EAAmCoB,MAAnC,CAA0C,OAA1C;AACAQ,gBAAQC,GAAR,CAAY,SAAZ;AACA7B,UAAE,kBAAF,EAAsB8B,IAAtB,CAA2BC,SAAS/B,EAAE,kBAAF,EAAsB8B,IAAtB,EAAT,IAAyC,CAApE;AACA,YAAIE,KAAKhC,EAAE2B,IAAF,EAAQM,QAAR,CAAiB,mBAAjB,EAAsCT,IAAtC,CAA2C,IAA3C,CAAT;AACAtB,eAAOgC,OAAP,CAAe,EAAf;AACA;AACAlC,UAAE,qBAAF,EAAyBmC,KAAzB;AACAnC,UAAE,oBAAF,EAAwBW,GAAxB,CAA4B,EAA5B;AACAX,UAAE,iBAAF,EAAqBoC,IAArB;;AAEAvB,cAAMQ,IAAN,CAAW,eAAX,EAA4BgB,UAA5B,CAAuC,UAAvC;;AAEAC,eAAOC,QAAP,CAAgBC,IAAhB,GAAuB,MAAMR,EAA7B;AACD,OAlBI;AAmBLS,aAAO,eAAUhC,IAAV,EAAgB;AACrBT,UAAE,+BAAF,EAAmCoB,MAAnC,CAA0C,OAA1C;AACD;AArBI,KAAP;AAuBD;AACF,CA7BD;;AA+BApB,EAAE,yBAAF,EAA6BkB,KAA7B,CAAmC,YAAY;AAC7C,MAAIwB,OAAO1C,EAAE,IAAF,CAAX;AACA,MAAI,CAAC2C,QAAQD,KAAKjC,IAAL,CAAU,gBAAV,CAAR,CAAL,EAA2C;AACzC,WAAO,KAAP;AACD;AACDT,IAAE4C,IAAF,CAAOF,KAAKjC,IAAL,CAAU,KAAV,CAAP,EAAyB,YAAY;AACnC,QAAIoC,MAAMH,KAAKjC,IAAL,CAAU,UAAV,CAAV;AACA,QAAIoC,GAAJ,EAAS;AACPP,aAAOC,QAAP,CAAgBC,IAAhB,GAAuBK,GAAvB;AACD,KAFD,MAEO;AACLP,aAAOC,QAAP,CAAgBO,MAAhB;AACD;AACF,GAPD;AAQD,CAbD;;AAeA9C,EAAE,mBAAF,EAAuBU,EAAvB,CAA0B,OAA1B,EAAmC,mBAAnC,EAAwD,YAAW;AACjE,MAAMqC,WAAW/C,EAAE,IAAF,EAAQgD,MAAR,GAAiBvC,IAAjB,CAAsB,MAAtB,CAAjB;AACAP,SAAO+C,KAAP;AACA/C,SAAOgD,UAAP,CAAkB,MAAMH,QAAN,GAAiB,QAAnC;AACD,CAJD;;AAMA/C,EAAE,mBAAF,EAAuBU,EAAvB,CAA0B,OAA1B,EAAmC,2BAAnC,EAAgE,YAAY;AAC1E,MAAI,CAACiC,QAAQQ,WAAWC,KAAX,CAAiB,2BAAjB,CAAR,CAAL,EAA6D;AAC3D,WAAO,KAAP;AACD;AACD,MAAIV,OAAO1C,EAAE,IAAF,CAAX;AACAA,IAAE4C,IAAF,CAAOF,KAAKjC,IAAL,CAAU,KAAV,CAAP,EAAyB,YAAY;AACnC6B,WAAOC,QAAP,CAAgBO,MAAhB;AACD,GAFD;AAGD,CARD;;AAYA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,M","file":"app/js/course/thread-show/index.js","sourcesContent":["module.exports = jQuery;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jQuery\"\n// module id = 0\n// module chunks = app/js/main app/js/v2/demo/index app/js/activity-manage/doc/index app/js/activity-manage/download/index app/js/activity-manage/flash/index app/js/activity-manage/homework/index app/js/activity-manage/ppt/index app/js/activity-manage/video/index app/js/article/detail/index app/js/attachment/index app/js/auth/captcha-modal/index app/js/auth/password-reset/index app/js/auth/register/index app/js/batch-upload/index app/js/card/card-receive/index app/js/card/index/index app/js/cashier/index app/js/cashier/modal/index app/js/classroom-manage/set-picture/index app/js/classroom-manage/student-expiryday/index app/js/classroom-manage/student-import/index app/js/classroom-manage/students-create/index app/js/classroom-manage/students-manage/index app/js/classroom/buy-modal/index app/js/classroom/index app/js/classroom/thread-form/index app/js/classroom/thread-show/index app/js/coin/invite-code/index app/js/course-chapter-manage/index app/js/course-manage-file/index/index app/js/course-manage/batch-create/index app/js/course-manage/lesson-manage/default/index app/js/course-manage/lesson-manage/normal/index app/js/course-manage/live-replay/upload/index app/js/course-manage/overview/index app/js/course-manage/student-import/index app/js/course/buy-modal/index app/js/course/thread-show/index app/js/courseset/show/index app/js/exporter/index app/js/group/index app/js/group/logo/index app/js/group/thread-add/index app/js/live-course/explore/index app/js/material-lib/index/index app/js/material-lib/share-history/index app/js/media-manage/index app/js/activity-manage/audio/index app/js/mobile-bind/index app/js/my/order-refund-apply/index app/js/my/order-refund/index app/js/my/order/index app/js/oauth2/create/index app/js/open-course-manage/add-material/index app/js/open-course-manage/lesson-modal/index app/js/open-course/index app/js/open-course/member-sms/index app/js/order/coupon-item/index app/js/order/create-sms/index app/js/order/create/index app/js/pay/select/index app/js/pay/show-mobile-modal/index app/js/player/index app/js/question-manage/form/index app/js/review/list/index app/js/search/index app/js/settings/avatar-crop-modal/index app/js/settings/bind-mobile/index app/js/settings/email/index app/js/settings/find_pay_password_by_sms/index app/js/settings/find-pay-password/index app/js/settings/password/index app/js/settings/pay-password-modal/index app/js/settings/pay-password/index app/js/settings/profile/index app/js/settings/reset-pay-password/index app/js/settings/security-questions/index app/js/settings/security/index app/js/settings/setup-password/index app/js/settings/setup/index app/js/settings/update-pay-password/index app/js/settings/user-profile/index app/js/subject/index app/js/task-manage/create/index app/js/task/plugin/note/index app/js/task/plugin/question/index app/js/testpaper-manage/create/index app/js/testpaper-manage/index app/js/testpaper-manage/questions/index app/js/testpaper/do-test/exercise/index app/js/testpaper/do-test/normal/index app/js/testpaper/result/index app/js/thread/user-info-modal/index app/js/user/fill-info/index app/js/message/show/index","import notify from 'common/notify';\n\nif ($('#post_content').length != 0) {\n  var editor = CKEDITOR.replace('post_content', {\n    toolbar: 'Thread',\n    fileSingleSizeLimit: app.fileSingleSizeLimit,\n    filebrowserImageUploadUrl: $('#post_content').data('imageUploadUrl')\n  });\n  editor.on('change', () => {\n    $('#post_content').val(editor.getData());\n  });\n  editor.on('blur', () => {\n    $('#post_content').val(editor.getData());\n  });\n}\n\nlet $form = $('#thread-post-form');\n\nlet validator = $form.validate({\n  rules: {\n    'post[content]': {\n      required: true,\n    }\n  }\n});\n\n\n$('.js-btn-thread-post-form-save').click(() => {\n  if (validator.form()) {\n    $('.js-btn-thread-post-form-save').button('loading');\n    $('.thread-post-list').find('li.empty').remove();\n    var $form = $('#thread-post-form');\n    $.ajax({\n      'url': $form.attr('action'),\n      'type': 'post',\n      'data': $form.serialize(),\n      success: function (html) {\n        $('.js-btn-thread-post-form-save').button('reset');\n        console.log('success');\n        $('#thread-post-num').text(parseInt($('#thread-post-num').text()) + 1);\n        var id = $(html).appendTo('.thread-post-list').attr('id');\n        editor.setData('');\n        //清除附件\n        $('.js-attachment-list').empty();\n        $('.js-attachment-ids').val('');\n        $('.js-upload-file').show();\n\n        $form.find('[type=submit]').removeAttr('disabled');\n\n        window.location.href = '#' + id;\n      },\n      error: function (data) {\n        $('.js-btn-thread-post-form-save').button('reset');\n      }\n    });\n  }\n});\n\n$('[data-role=confirm-btn]').click(function () {\n  var $btn = $(this);\n  if (!confirm($btn.data('confirmMessage'))) {\n    return false;\n  }\n  $.post($btn.data('url'), function () {\n    var url = $btn.data('afterUrl');\n    if (url) {\n      window.location.href = url;\n    } else {\n      window.location.reload();\n    }\n  });\n});\n\n$('.thread-post-list').on('click', '.js-call-username', function() {\n  const userName = $(this).parent().data('user');\n  editor.focus();\n  editor.insertHtml('@' + userName + '&nbsp;');\n});\n\n$('.thread-post-list').on('click', '[data-action=post-delete]', function () {\n  if (!confirm(Translator.trans('course.thread_delete_hint'))) {\n    return false;\n  }\n  var $btn = $(this);\n  $.post($btn.data('url'), function () {\n    window.location.reload();\n  });\n});\n\n\n\n// var validator = new Validator({\n//   element: '#thread-post-form'\n// });\n\n// validator.addItem({\n//   element: '[name=\"post[content]\"]',\n//   required: true\n// });\n\n// Validator.query('#thread-post-form').on('formValidate', function (elemetn, event) {\n//   editor.updateElement();\n// });\n\n// Validator.query('#thread-post-form').on('formValidated', function (err, msg, ele) {\n//   if (err == true) {\n//     return;\n//   }\n\n//   $('.thread-post-list').find('li.empty').remove();\n//   var $form = $(\"#thread-post-form\");\n\n//   $.ajax({\n//     'url': $form.attr('action'),\n//     'type': 'post',\n//     'data': $form.serialize(),\n//     'success': function (html) {\n//       $(\"#thread-post-num\").text(parseInt($(\"#thread-post-num\").text()) + 1);\n//       var id = $(html).appendTo('.thread-post-list').attr('id');\n//       editor.setData('');\n//       //清除附件\n//       $('.js-attachment-list').empty();\n//       $('.js-attachment-ids').val(\"\");\n//       $('.js-upload-file').removeClass('hidden');\n\n//       $form.find('[type=submit]').removeAttr('disabled');\n\n//       window.location.href = '#' + id;\n//     },\n//     'error': function (data) {\n//       data = $.parseJSON(data.responseText);\n//       if (data.error) {\n//         Notify.danger(data.error.message);\n//       } else {\n//         Notify.danger(Translator.trans('发表回复失败，请重试'));\n//       }\n//     }\n//   });\n\n//   return false;\n// });\n\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/course/thread-show/index.js"],"sourceRoot":""}